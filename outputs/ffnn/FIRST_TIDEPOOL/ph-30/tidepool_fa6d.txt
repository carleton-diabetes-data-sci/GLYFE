2024-04-21 10:31:26 tidepool fa6d ffnn ffnn FIRST_TIDEPOOL test None 30 1
             datetime  glucose  CHO  insulin
0 2015-09-07 17:00:00    104.0  NaN      NaN
1 2015-09-07 17:05:00     99.0  NaN      NaN
2 2015-09-07 17:10:00     96.0  NaN      NaN
3 2015-09-07 17:15:00     94.0  NaN      NaN
4 2015-09-07 17:20:00     94.0  NaN      NaN
Printing heads of split dataset
Train
               datetime   time  glucose_0  ...  insulin_34  insulin_35     y
100 2015-09-08 08:20:00  100.0      167.0  ...         0.0         0.0  98.0
101 2015-09-08 08:25:00  101.0      171.0  ...         0.0         0.0  96.0
102 2015-09-08 08:30:00  102.0      172.0  ...         0.0         0.0  84.0
103 2015-09-08 08:35:00  103.0      173.0  ...         0.0         0.0  85.0
104 2015-09-08 08:40:00  104.0      175.0  ...         0.0         0.0  90.0
105 2015-09-08 08:45:00  105.0      176.0  ...         0.0         0.0  88.0
106 2015-09-08 08:50:00  106.0      179.0  ...         0.0         0.0  85.0
107 2015-09-08 08:55:00  107.0      177.0  ...         0.0         0.0  78.0
108 2015-09-08 09:00:00  108.0      173.0  ...         0.0         0.0  78.0
109 2015-09-08 09:05:00  109.0      173.0  ...         0.0         0.0  82.0

[10 rows x 111 columns]
Valid
               datetime   time  glucose_0  ...  insulin_34  insulin_35      y
100 2015-09-10 08:20:00  100.0       96.0  ...         0.0         0.0  113.0
101 2015-09-10 08:25:00  101.0       91.0  ...         0.0         0.0  116.0
102 2015-09-10 08:30:00  102.0       91.0  ...         0.0         0.0  141.0
103 2015-09-10 08:35:00  103.0       89.0  ...         0.0         0.0  133.0
104 2015-09-10 08:40:00  104.0       89.0  ...         0.0         0.0  133.0
105 2015-09-10 08:45:00  105.0       87.0  ...         0.0         0.0  133.0
106 2015-09-10 08:50:00  106.0       85.0  ...         0.0         0.0  146.0
107 2015-09-10 08:55:00  107.0       83.0  ...         0.0         0.0  152.0
108 2015-09-10 09:00:00  108.0       82.0  ...         0.0         0.0  156.0
109 2015-09-10 09:05:00  109.0       81.0  ...         0.0         0.0  162.0

[10 rows x 111 columns]
Test
                  datetime   time  glucose_0  ...  insulin_34  insulin_35      y
265595 2018-03-17 08:20:00  100.0      128.0  ...         0.0         0.0  134.0
265596 2018-03-17 08:25:00  101.0      126.0  ...         0.0         0.0  135.0
265597 2018-03-17 08:30:00  102.0      127.0  ...         0.0         0.0  133.0
265598 2018-03-17 08:35:00  103.0      127.0  ...         0.0         0.0  131.0
265599 2018-03-17 08:40:00  104.0      127.0  ...         0.0         0.0  127.0
265600 2018-03-17 08:45:00  105.0      126.0  ...         0.0         0.0  121.0
265601 2018-03-17 08:50:00  106.0      126.0  ...         0.0         0.0  119.0
265602 2018-03-17 08:55:00  107.0      127.0  ...         0.0         0.0  114.0
265603 2018-03-17 09:00:00  108.0      127.0  ...         0.0         0.0  108.0
265604 2018-03-17 09:05:00  109.0      126.0  ...         0.0         0.0  105.0

[10 rows x 111 columns]
2024-04-21 10:33:29 Saved model's file: ./tmp/lstm_weights/9358753.pt
2024-04-21 10:33:31 0 [train] 1.1109969185319903 [valid] 1.0258670429510182
2024-04-21 10:33:32 0 [train] 0.4012018995179761 [valid] 0.3669079991167772
2024-04-21 10:33:34 1 [train] 0.33882757398948327 [valid] 0.30752332558373136
2024-04-21 10:33:36 2 [train] 0.31761781887474216 [valid] 0.2886075596571436
2024-04-21 10:33:37 3 [train] 0.30768429730237445 [valid] 0.27979331003305274
2024-04-21 10:33:39 4 [train] 0.30130511455040865 [valid] 0.27501005091966135
2024-04-21 10:33:41 5 [train] 0.2973473506559346 [valid] 0.27075383658736246
2024-04-21 10:33:42 6 [train] 0.2940598571329399 [valid] 0.26893036013076177
2024-04-21 10:33:44 7 [train] 0.2911190838369266 [valid] 0.26618910725390776
2024-04-21 10:33:46 8 [train] 0.288950929421606 [valid] 0.263605221362824
2024-04-21 10:33:48 9 [train] 0.2866669502333897 [valid] 0.2621179719382607
2024-04-21 10:33:49 10 [train] 0.284682291964438 [valid] 0.2605460935826823
2024-04-21 10:33:51 11 [train] 0.2835114689671864 [valid] 0.25964972917203955
2024-04-21 10:33:53 12 [train] 0.2812488152366311 [valid] 0.2567136147356597
2024-04-21 10:33:54 13 [train] 0.27967549950558274 [valid] 0.2557172479076679
2024-04-21 10:33:56 14 [train] 0.2782001580825903 [valid] 0.2538101364973074
2024-04-21 10:33:58 15 [train] 0.27735010534012167 [valid] 0.2535388088979029
2024-04-21 10:34:00 16 [train] 0.27589060834065726 [valid] 0.25173634024397645
2024-04-21 10:34:02 17 [train] 0.2746394704253941 [valid] 0.25050885737816386
2024-04-21 10:34:03 18 [train] 0.2740463921258801 [valid] 0.25012008382483786
2024-04-21 10:34:05 19 [train] 0.27275423982716474 [valid] 0.2486310122155424
2024-04-21 10:34:07 EarlyStopping counter: 1 out of 100
2024-04-21 10:34:07 20 [train] 0.27498145218982767 [valid] 0.25143360335098724
2024-04-21 10:34:08 21 [train] 0.2709965834511343 [valid] 0.247720609111556
2024-04-21 10:34:10 22 [train] 0.27105551531028754 [valid] 0.2473938605521797
2024-04-21 10:34:12 EarlyStopping counter: 1 out of 100
2024-04-21 10:34:12 23 [train] 0.27038750026457803 [valid] 0.24767617587132174
2024-04-21 10:34:14 24 [train] 0.2699199246934096 [valid] 0.24606273838508047
2024-04-21 10:34:15 25 [train] 0.2681037243767944 [valid] 0.24512201274689815
2024-04-21 10:34:17 26 [train] 0.2675663318927809 [valid] 0.24432180427846012
2024-04-21 10:34:19 27 [train] 0.26673901049874227 [valid] 0.2432302674727054
2024-04-21 10:34:20 28 [train] 0.2650755818171292 [valid] 0.24243720280124748
2024-04-21 10:34:22 29 [train] 0.26412672668021 [valid] 0.2415759489263158
2024-04-21 10:34:24 EarlyStopping counter: 1 out of 100
2024-04-21 10:34:24 30 [train] 0.2648411700648711 [valid] 0.2435477854505837
2024-04-21 10:34:25 31 [train] 0.2629930756020756 [valid] 0.24079943083141306
2024-04-21 10:34:27 EarlyStopping counter: 1 out of 100
2024-04-21 10:34:27 32 [train] 0.26271147534743605 [valid] 0.2408255013281536
2024-04-21 10:34:29 EarlyStopping counter: 2 out of 100
2024-04-21 10:34:29 33 [train] 0.2637823327054997 [valid] 0.24307383401199395
2024-04-21 10:34:30 EarlyStopping counter: 3 out of 100
2024-04-21 10:34:30 34 [train] 0.2616159341035695 [valid] 0.24088464181896543
2024-04-21 10:34:32 35 [train] 0.260523899207667 [valid] 0.23887100028470074
2024-04-21 10:34:34 EarlyStopping counter: 1 out of 100
2024-04-21 10:34:34 36 [train] 0.2603331983007407 [valid] 0.23893856389420068
2024-04-21 10:34:36 EarlyStopping counter: 2 out of 100
2024-04-21 10:34:36 37 [train] 0.2605280211205326 [valid] 0.23918452981103241
2024-04-21 10:34:37 38 [train] 0.2595296673824253 [valid] 0.23841362051656492
2024-04-21 10:34:39 EarlyStopping counter: 1 out of 100
2024-04-21 10:34:39 39 [train] 0.2590291604119228 [valid] 0.238542215472756
2024-04-21 10:34:41 40 [train] 0.2583785015459179 [valid] 0.23809735165199064
2024-04-21 10:34:43 41 [train] 0.25840650275782856 [valid] 0.23724681719273236
2024-04-21 10:34:44 EarlyStopping counter: 1 out of 100
2024-04-21 10:34:44 42 [train] 0.25829305149969056 [valid] 0.2393131378644621
2024-04-21 10:34:46 43 [train] 0.2573564336085961 [valid] 0.23710425928317333
2024-04-21 10:34:48 EarlyStopping counter: 1 out of 100
2024-04-21 10:34:48 44 [train] 0.25706341729987287 [valid] 0.23744600276967406
2024-04-21 10:34:49 EarlyStopping counter: 2 out of 100
2024-04-21 10:34:49 45 [train] 0.25730368329420683 [valid] 0.23888441150140885
2024-04-21 10:34:51 EarlyStopping counter: 3 out of 100
2024-04-21 10:34:51 46 [train] 0.25753442219833766 [valid] 0.23881349223056272
2024-04-21 10:34:53 EarlyStopping counter: 4 out of 100
2024-04-21 10:34:53 47 [train] 0.2574478059564494 [valid] 0.23796692936117375
2024-04-21 10:34:55 48 [train] 0.25542996486664543 [valid] 0.23671512965552846
2024-04-21 10:34:56 49 [train] 0.254973910795998 [valid] 0.23613281172729478
2024-04-21 10:34:58 50 [train] 0.2548273859237733 [valid] 0.23609381249191175
2024-04-21 10:35:00 EarlyStopping counter: 1 out of 100
2024-04-21 10:35:00 51 [train] 0.2557409115061284 [valid] 0.2376099748608053
2024-04-21 10:35:02 52 [train] 0.254335647184663 [valid] 0.23607790602475823
2024-04-21 10:35:03 53 [train] 0.2541506370933362 [valid] 0.23590212810271668
2024-04-21 10:35:05 54 [train] 0.2539667070540338 [valid] 0.23532754301189676
2024-04-21 10:35:07 EarlyStopping counter: 1 out of 100
2024-04-21 10:35:07 55 [train] 0.25445538048631916 [valid] 0.23682711978235557
2024-04-21 10:35:09 EarlyStopping counter: 2 out of 100
2024-04-21 10:35:09 56 [train] 0.2540591777145629 [valid] 0.23642746049948163
2024-04-21 10:35:11 EarlyStopping counter: 3 out of 100
2024-04-21 10:35:11 57 [train] 0.2543038878694611 [valid] 0.23630412160299216
2024-04-21 10:35:13 58 [train] 0.2532135598249504 [valid] 0.2351048580657655
2024-04-21 10:35:15 EarlyStopping counter: 1 out of 100
2024-04-21 10:35:15 59 [train] 0.2527033205534031 [valid] 0.2352016052663705
2024-04-21 10:35:18 EarlyStopping counter: 2 out of 100
2024-04-21 10:35:18 60 [train] 0.25273142719584835 [valid] 0.2352605699539142
2024-04-21 10:35:20 EarlyStopping counter: 3 out of 100
2024-04-21 10:35:20 61 [train] 0.252599437527482 [valid] 0.2357381809701236
2024-04-21 10:35:22 EarlyStopping counter: 4 out of 100
2024-04-21 10:35:22 62 [train] 0.25278036015156735 [valid] 0.23605606957667585
2024-04-21 10:35:25 EarlyStopping counter: 5 out of 100
2024-04-21 10:35:25 63 [train] 0.2522856474167661 [valid] 0.2355008289976145
2024-04-21 10:35:28 EarlyStopping counter: 6 out of 100
2024-04-21 10:35:28 64 [train] 0.25515707597640186 [valid] 0.23750979070998085
2024-04-21 10:35:30 EarlyStopping counter: 7 out of 100
2024-04-21 10:35:30 65 [train] 0.25226540604997877 [valid] 0.23607180652376777
2024-04-21 10:35:32 EarlyStopping counter: 8 out of 100
2024-04-21 10:35:32 66 [train] 0.25262570403577006 [valid] 0.23540235776813623
2024-04-21 10:35:35 EarlyStopping counter: 9 out of 100
2024-04-21 10:35:35 67 [train] 0.2518987378863669 [valid] 0.23514772458731303
2024-04-21 10:35:37 EarlyStopping counter: 10 out of 100
2024-04-21 10:35:37 68 [train] 0.25171862619021823 [valid] 0.235263855236624
2024-04-21 10:35:39 EarlyStopping counter: 11 out of 100
2024-04-21 10:35:39 69 [train] 0.25196435301671094 [valid] 0.23519773673276567
2024-04-21 10:35:42 70 [train] 0.25138583014695787 [valid] 0.2349806311589794
2024-04-21 10:35:45 EarlyStopping counter: 1 out of 100
2024-04-21 10:35:45 71 [train] 0.25187143808782764 [valid] 0.23558857504488318
2024-04-21 10:35:47 EarlyStopping counter: 2 out of 100
2024-04-21 10:35:47 72 [train] 0.2515426490806729 [valid] 0.2361868993230821
2024-04-21 10:35:49 EarlyStopping counter: 3 out of 100
2024-04-21 10:35:49 73 [train] 0.2515794478640784 [valid] 0.23552461217274712
2024-04-21 10:35:51 EarlyStopping counter: 4 out of 100
2024-04-21 10:35:51 74 [train] 0.25096345876029424 [valid] 0.23498246207137025
2024-04-21 10:35:53 EarlyStopping counter: 5 out of 100
2024-04-21 10:35:53 75 [train] 0.2510285948146126 [valid] 0.23550095255967451
2024-04-21 10:35:56 76 [train] 0.25040220738341884 [valid] 0.23484217120764805
2024-04-21 10:35:58 EarlyStopping counter: 1 out of 100
2024-04-21 10:35:58 77 [train] 0.25095247606513893 [valid] 0.23504541867586748
2024-04-21 10:36:01 78 [train] 0.2512233473707649 [valid] 0.2344481552244542
2024-04-21 10:36:03 EarlyStopping counter: 1 out of 100
2024-04-21 10:36:03 79 [train] 0.25080309862011435 [valid] 0.2351831826342403
2024-04-21 10:36:06 EarlyStopping counter: 2 out of 100
2024-04-21 10:36:06 80 [train] 0.25048625806732194 [valid] 0.23556074367908333
2024-04-21 10:36:09 EarlyStopping counter: 3 out of 100
2024-04-21 10:36:09 81 [train] 0.25090220373920247 [valid] 0.23459910016982663
2024-04-21 10:36:12 EarlyStopping counter: 4 out of 100
2024-04-21 10:36:12 82 [train] 0.2513367744143859 [valid] 0.23722727559336587
2024-04-21 10:36:14 83 [train] 0.2496708057882996 [valid] 0.23442354216443553
2024-04-21 10:36:17 84 [train] 0.250545506051769 [valid] 0.23440407239374422
2024-04-21 10:36:19 EarlyStopping counter: 1 out of 100
2024-04-21 10:36:19 85 [train] 0.24997350261920415 [valid] 0.23442928371109958
2024-04-21 10:36:21 EarlyStopping counter: 2 out of 100
2024-04-21 10:36:21 86 [train] 0.25399586245429634 [valid] 0.23941366364053074
2024-04-21 10:36:24 EarlyStopping counter: 3 out of 100
2024-04-21 10:36:24 87 [train] 0.24988105748880904 [valid] 0.23480898736120295
2024-04-21 10:36:28 EarlyStopping counter: 4 out of 100
2024-04-21 10:36:28 88 [train] 0.25083398934271994 [valid] 0.23482896706957168
2024-04-21 10:36:32 EarlyStopping counter: 5 out of 100
2024-04-21 10:36:32 89 [train] 0.24981582907377603 [valid] 0.23444872341140152
2024-04-21 10:36:36 90 [train] 0.2488826648142637 [valid] 0.23408230540942518
2024-04-21 10:36:39 EarlyStopping counter: 1 out of 100
2024-04-21 10:36:39 91 [train] 0.25072385009575754 [valid] 0.2365365596585989
2024-04-21 10:36:41 EarlyStopping counter: 2 out of 100
2024-04-21 10:36:41 92 [train] 0.24992529912155495 [valid] 0.2349218604404428
2024-04-21 10:36:44 EarlyStopping counter: 3 out of 100
2024-04-21 10:36:44 93 [train] 0.25018211967729703 [valid] 0.23568030123008385
2024-04-21 10:36:46 EarlyStopping counter: 4 out of 100
2024-04-21 10:36:46 94 [train] 0.24937563407679242 [valid] 0.23487567743159865
2024-04-21 10:36:48 EarlyStopping counter: 5 out of 100
2024-04-21 10:36:48 95 [train] 0.24969224710542048 [valid] 0.23440513329042192
2024-04-21 10:36:50 EarlyStopping counter: 6 out of 100
2024-04-21 10:36:50 96 [train] 0.24864629695840704 [valid] 0.2342150078167763
2024-04-21 10:36:54 97 [train] 0.24937360759288466 [valid] 0.23407360752210093
2024-04-21 10:36:57 EarlyStopping counter: 1 out of 100
2024-04-21 10:36:57 98 [train] 0.24946743074368594 [valid] 0.23492389593746943
2024-04-21 10:36:59 EarlyStopping counter: 2 out of 100
2024-04-21 10:36:59 99 [train] 0.24906003442729793 [valid] 0.23434689307021025
2024-04-21 10:37:02 EarlyStopping counter: 3 out of 100
2024-04-21 10:37:02 100 [train] 0.2489604313657425 [valid] 0.23445989697497466
2024-04-21 10:37:05 101 [train] 0.24882523044251967 [valid] 0.23379371005813732
2024-04-21 10:37:08 EarlyStopping counter: 1 out of 100
2024-04-21 10:37:08 102 [train] 0.251030389801793 [valid] 0.23799626800026327
2024-04-21 10:37:10 EarlyStopping counter: 2 out of 100
2024-04-21 10:37:10 103 [train] 0.24842648554122448 [valid] 0.23408001572918186
2024-04-21 10:37:12 104 [train] 0.24800998010550934 [valid] 0.23344540036606518
2024-04-21 10:37:14 EarlyStopping counter: 1 out of 100
2024-04-21 10:37:14 105 [train] 0.24937610082834608 [valid] 0.2338219247588082
2024-04-21 10:37:16 EarlyStopping counter: 2 out of 100
2024-04-21 10:37:16 106 [train] 0.2484140214708071 [valid] 0.23428237101393018
2024-04-21 10:37:19 EarlyStopping counter: 3 out of 100
2024-04-21 10:37:19 107 [train] 0.2482287390702379 [valid] 0.23489706467111413
2024-04-21 10:37:23 EarlyStopping counter: 4 out of 100
2024-04-21 10:37:23 108 [train] 0.24816965282330747 [valid] 0.23356749352884074
2024-04-21 10:37:27 EarlyStopping counter: 5 out of 100
2024-04-21 10:37:27 109 [train] 0.24875713814932746 [valid] 0.23478197718890356
2024-04-21 10:37:31 EarlyStopping counter: 6 out of 100
2024-04-21 10:37:31 110 [train] 0.2487549054443826 [valid] 0.2342348045088408
2024-04-21 10:37:34 EarlyStopping counter: 7 out of 100
2024-04-21 10:37:34 111 [train] 0.24805141126029567 [valid] 0.23393470770738856
2024-04-21 10:37:36 EarlyStopping counter: 8 out of 100
2024-04-21 10:37:36 112 [train] 0.248215351632404 [valid] 0.23425440303749068
2024-04-21 10:37:39 EarlyStopping counter: 9 out of 100
2024-04-21 10:37:39 113 [train] 0.247317586607896 [valid] 0.23399048302534292
2024-04-21 10:37:41 EarlyStopping counter: 10 out of 100
2024-04-21 10:37:41 114 [train] 0.24775226993033522 [valid] 0.23403921886594675
2024-04-21 10:37:43 EarlyStopping counter: 11 out of 100
2024-04-21 10:37:43 115 [train] 0.24843718157097935 [valid] 0.23485163827640443
2024-04-21 10:37:45 EarlyStopping counter: 12 out of 100
2024-04-21 10:37:45 116 [train] 0.24708577047172683 [valid] 0.23398759335461713
2024-04-21 10:37:47 117 [train] 0.24721683565502642 [valid] 0.23334466260742037
2024-04-21 10:37:49 EarlyStopping counter: 1 out of 100
2024-04-21 10:37:49 118 [train] 0.24755529108353982 [valid] 0.23427341153571704
2024-04-21 10:37:52 EarlyStopping counter: 2 out of 100
2024-04-21 10:37:52 119 [train] 0.24728071306795638 [valid] 0.23441352259020676
2024-04-21 10:37:56 EarlyStopping counter: 3 out of 100
2024-04-21 10:37:56 120 [train] 0.24746902983709715 [valid] 0.23415002953618338
2024-04-21 10:38:00 EarlyStopping counter: 4 out of 100
2024-04-21 10:38:00 121 [train] 0.24691772586762328 [valid] 0.23384531171327672
2024-04-21 10:38:04 EarlyStopping counter: 5 out of 100
2024-04-21 10:38:04 122 [train] 0.2485060881976718 [valid] 0.23558284790394304
2024-04-21 10:38:08 EarlyStopping counter: 6 out of 100
2024-04-21 10:38:08 123 [train] 0.24880364660715648 [valid] 0.23566131072507818
2024-04-21 10:38:11 EarlyStopping counter: 7 out of 100
2024-04-21 10:38:11 124 [train] 0.24739915578750393 [valid] 0.23408740298050723
2024-04-21 10:38:15 EarlyStopping counter: 8 out of 100
2024-04-21 10:38:15 125 [train] 0.2481798812564343 [valid] 0.2344792054710964
