2024-04-21 13:33:18 tidepool fcb9 lstm lstm FIRST_TIDEPOOL test None 120 1
             datetime  glucose  CHO  insulin
0 2017-10-14 14:00:00    165.0  NaN      NaN
1 2017-10-14 14:05:00    163.0  NaN      NaN
2 2017-10-14 14:10:00    159.0  NaN      NaN
3 2017-10-14 14:15:00    158.0  NaN      NaN
4 2017-10-14 14:20:00    158.0  NaN      NaN
Printing heads of split dataset
Train
               datetime   time  glucose_0  ...  insulin_34  insulin_35      y
100 2017-10-15 08:20:00  100.0      150.0  ...         0.0         0.0   98.0
101 2017-10-15 08:25:00  101.0      150.0  ...         0.0         0.0  146.0
102 2017-10-15 08:30:00  102.0      150.0  ...         0.0         0.0  152.0
103 2017-10-15 08:35:00  103.0      151.0  ...         0.0         0.0  158.0
104 2017-10-15 08:40:00  104.0      150.0  ...         0.0         0.0  158.0
105 2017-10-15 08:45:00  105.0      149.0  ...         0.0         0.0  149.0
106 2017-10-15 08:50:00  106.0      123.0  ...         0.0         0.0  140.0
107 2017-10-15 08:55:00  107.0        NaN  ...         0.0         0.0  124.0
108 2017-10-15 09:00:00  108.0        NaN  ...         0.0         0.0  116.0
109 2017-10-15 09:05:00  109.0        NaN  ...         0.0         0.0  109.0

[10 rows x 111 columns]
Valid
               datetime   time  glucose_0  ...  insulin_34  insulin_35      y
100 2017-10-19 08:20:00  100.0      146.0  ...         0.0         0.0  139.0
101 2017-10-19 08:25:00  101.0      145.0  ...         0.0         0.0  139.0
102 2017-10-19 08:30:00  102.0      144.0  ...         0.0         0.0  139.0
103 2017-10-19 08:35:00  103.0      140.0  ...         0.0         0.0  138.0
104 2017-10-19 08:40:00  104.0      137.0  ...         0.0         0.0  138.0
105 2017-10-19 08:45:00  105.0      137.0  ...         0.0         0.0  138.0
106 2017-10-19 08:50:00  106.0      128.0  ...         0.0         0.0  139.0
107 2017-10-19 08:55:00  107.0      124.0  ...         0.0         0.0  138.0
108 2017-10-19 09:00:00  108.0      123.0  ...         0.0         0.0  138.0
109 2017-10-19 09:05:00  109.0      123.0  ...         0.0         0.0  139.0

[10 rows x 111 columns]
Test
                 datetime   time   glucose_0  ...  insulin_34  insulin_35   y
84425 2018-08-03 08:20:00  100.0  108.285714  ...         0.0         0.0 NaN
84426 2018-08-03 08:25:00  101.0  108.000000  ...         0.0         0.0 NaN
84427 2018-08-03 08:30:00  102.0  107.000000  ...         0.0         0.0 NaN
84428 2018-08-03 08:35:00  103.0  106.000000  ...         0.0         0.0 NaN
84429 2018-08-03 08:40:00  104.0  108.000000  ...         0.0         0.0 NaN
84430 2018-08-03 08:45:00  105.0  111.000000  ...         0.0         0.0 NaN
84431 2018-08-03 08:50:00  106.0  118.000000  ...         0.0         0.0 NaN
84432 2018-08-03 08:55:00  107.0  120.000000  ...         0.0         0.0 NaN
84433 2018-08-03 09:00:00  108.0  121.000000  ...         0.0         0.0 NaN
84434 2018-08-03 09:05:00  109.0  120.000000  ...         0.0         0.0 NaN

[10 rows x 111 columns]
2024-04-21 13:33:55 Saved model's file: ./tmp/lstm_weights/8676379.pt
2024-04-21 13:33:57 0 [train] 1.004981684484973 [valid] 1.2376776664633256
2024-04-21 13:34:02 0 [train] 0.9124225671464969 [valid] 1.000398476545526
2024-04-21 13:34:07 1 [train] 0.8992277855628671 [valid] 0.977256444327858
2024-04-21 13:34:12 2 [train] 0.8682096907629672 [valid] 0.9392536996739692
2024-04-21 13:34:17 3 [train] 0.8579310052107199 [valid] 0.9128381000247175
2024-04-21 13:34:22 EarlyStopping counter: 1 out of 50
2024-04-21 13:34:22 4 [train] 0.8522633089818175 [valid] 0.9215530725889555
2024-04-21 13:34:27 5 [train] 0.8394909626578979 [valid] 0.9045267285009313
2024-04-21 13:34:32 EarlyStopping counter: 1 out of 50
2024-04-21 13:34:32 6 [train] 0.8261678805939309 [valid] 0.909415242052716
2024-04-21 13:34:36 EarlyStopping counter: 2 out of 50
2024-04-21 13:34:36 7 [train] 0.822302297036562 [valid] 0.9284772143819576
2024-04-21 13:34:41 8 [train] 0.8137088502908694 [valid] 0.8923187474782751
2024-04-21 13:34:46 EarlyStopping counter: 1 out of 50
2024-04-21 13:34:46 9 [train] 0.800836450592834 [valid] 0.9010888701869691
2024-04-21 13:34:50 EarlyStopping counter: 2 out of 50
2024-04-21 13:34:50 10 [train] 0.7942941083364109 [valid] 0.8978463909602205
2024-04-21 13:34:54 EarlyStopping counter: 3 out of 50
2024-04-21 13:34:54 11 [train] 0.796223941246052 [valid] 0.9231626746518056
2024-04-21 13:34:59 EarlyStopping counter: 4 out of 50
2024-04-21 13:34:59 12 [train] 0.787111473133971 [valid] 0.8997584904436339
2024-04-21 13:35:03 EarlyStopping counter: 5 out of 50
2024-04-21 13:35:03 13 [train] 0.782056873469621 [valid] 0.9164296432302239
2024-04-21 13:35:08 EarlyStopping counter: 6 out of 50
2024-04-21 13:35:08 14 [train] 0.7756488179040443 [valid] 0.9190123336377731
2024-04-21 13:35:12 EarlyStopping counter: 7 out of 50
2024-04-21 13:35:12 15 [train] 0.7678031685927277 [valid] 0.9180480990763302
2024-04-21 13:35:16 EarlyStopping counter: 8 out of 50
2024-04-21 13:35:16 16 [train] 0.7591141194549211 [valid] 0.9254884530594716
2024-04-21 13:35:21 EarlyStopping counter: 9 out of 50
2024-04-21 13:35:21 17 [train] 0.758174132534411 [valid] 0.9350912787013657
2024-04-21 13:35:25 EarlyStopping counter: 10 out of 50
2024-04-21 13:35:25 18 [train] 0.7430342179175982 [valid] 0.9061819666414858
2024-04-21 13:35:29 EarlyStopping counter: 11 out of 50
2024-04-21 13:35:29 19 [train] 0.7336194534146712 [valid] 0.9250039304977953
2024-04-21 13:35:34 EarlyStopping counter: 12 out of 50
2024-04-21 13:35:34 20 [train] 0.7233765590356183 [valid] 0.9309968957374567
2024-04-21 13:35:38 EarlyStopping counter: 13 out of 50
2024-04-21 13:35:38 21 [train] 0.7125395431369519 [valid] 0.9396777827225782
2024-04-21 13:35:42 EarlyStopping counter: 14 out of 50
2024-04-21 13:35:42 22 [train] 0.6934551118344079 [valid] 0.9300090036907344
2024-04-21 13:35:47 EarlyStopping counter: 15 out of 50
2024-04-21 13:35:47 23 [train] 0.6801029823304086 [valid] 0.9754087173031545
2024-04-21 13:35:51 EarlyStopping counter: 16 out of 50
2024-04-21 13:35:51 24 [train] 0.6721623920162145 [valid] 0.9800388430506384
2024-04-21 13:35:55 EarlyStopping counter: 17 out of 50
2024-04-21 13:35:55 25 [train] 0.6587495180661139 [valid] 0.9698902604703581
2024-04-21 13:36:00 EarlyStopping counter: 18 out of 50
2024-04-21 13:36:00 26 [train] 0.6339077799385299 [valid] 0.9900513772694711
2024-04-21 13:36:05 EarlyStopping counter: 19 out of 50
2024-04-21 13:36:05 27 [train] 0.6233996189110859 [valid] 1.0033685659177336
2024-04-21 13:36:10 EarlyStopping counter: 20 out of 50
2024-04-21 13:36:10 28 [train] 0.605436880536554 [valid] 1.0023405496482498
2024-04-21 13:36:15 EarlyStopping counter: 21 out of 50
2024-04-21 13:36:15 29 [train] 0.5973458733585317 [valid] 1.018771286501322
2024-04-21 13:36:20 EarlyStopping counter: 22 out of 50
2024-04-21 13:36:20 30 [train] 0.5816293215122832 [valid] 1.0264755114735213
2024-04-21 13:36:25 EarlyStopping counter: 23 out of 50
2024-04-21 13:36:25 31 [train] 0.5605560434125059 [valid] 1.024715532935266
2024-04-21 13:36:30 EarlyStopping counter: 24 out of 50
2024-04-21 13:36:30 32 [train] 0.5576363300930579 [valid] 1.0460559106267577
2024-04-21 13:36:35 EarlyStopping counter: 25 out of 50
2024-04-21 13:36:35 33 [train] 0.5213725435080319 [valid] 1.0057420262522574
2024-04-21 13:36:40 EarlyStopping counter: 26 out of 50
2024-04-21 13:36:40 34 [train] 0.5126144828505367 [valid] 1.0703004227576207
2024-04-21 13:36:45 EarlyStopping counter: 27 out of 50
2024-04-21 13:36:45 35 [train] 0.486153447741975 [valid] 1.0292917567477309
2024-04-21 13:36:50 EarlyStopping counter: 28 out of 50
2024-04-21 13:36:50 36 [train] 0.4699220149247886 [valid] 1.0849910529151898
2024-04-21 13:36:55 EarlyStopping counter: 29 out of 50
2024-04-21 13:36:55 37 [train] 0.4451780490235986 [valid] 1.0869898680846894
2024-04-21 13:37:00 EarlyStopping counter: 30 out of 50
2024-04-21 13:37:00 38 [train] 0.45599782714687237 [valid] 1.0713592608130997
2024-04-21 13:37:05 EarlyStopping counter: 31 out of 50
2024-04-21 13:37:05 39 [train] 0.424184734438173 [valid] 1.134116310931758
2024-04-21 13:37:10 EarlyStopping counter: 32 out of 50
2024-04-21 13:37:10 40 [train] 0.39413390419369443 [valid] 1.11433169502088
2024-04-21 13:37:15 EarlyStopping counter: 33 out of 50
2024-04-21 13:37:15 41 [train] 0.3685661041539905 [valid] 1.1180919037401325
2024-04-21 13:37:20 EarlyStopping counter: 34 out of 50
2024-04-21 13:37:20 42 [train] 0.3585259935089033 [valid] 1.1667645694371012
2024-04-21 13:37:25 EarlyStopping counter: 35 out of 50
2024-04-21 13:37:25 43 [train] 0.3607414434944953 [valid] 1.1353660168961994
2024-04-21 13:37:30 EarlyStopping counter: 36 out of 50
2024-04-21 13:37:30 44 [train] 0.3195127251297414 [valid] 1.1740655459311085
2024-04-21 13:37:35 EarlyStopping counter: 37 out of 50
2024-04-21 13:37:35 45 [train] 0.30903426917942484 [valid] 1.1474595857552812
2024-04-21 13:37:40 EarlyStopping counter: 38 out of 50
2024-04-21 13:37:40 46 [train] 0.3081488378497439 [valid] 1.194913927284629
2024-04-21 13:37:45 EarlyStopping counter: 39 out of 50
2024-04-21 13:37:45 47 [train] 0.27001408783736947 [valid] 1.1606934266194138
2024-04-21 13:37:50 EarlyStopping counter: 40 out of 50
2024-04-21 13:37:50 48 [train] 0.25237966146225105 [valid] 1.2040579290986884
2024-04-21 13:37:55 EarlyStopping counter: 41 out of 50
2024-04-21 13:37:55 49 [train] 0.2741937062900632 [valid] 1.1913616365296869
2024-04-21 13:38:00 EarlyStopping counter: 42 out of 50
2024-04-21 13:38:00 50 [train] 0.23759551299872866 [valid] 1.2198823409307755
2024-04-21 13:38:05 EarlyStopping counter: 43 out of 50
2024-04-21 13:38:05 51 [train] 0.2210915656474066 [valid] 1.2230048517957488
2024-04-21 13:38:10 EarlyStopping counter: 44 out of 50
2024-04-21 13:38:10 52 [train] 0.20384395266993097 [valid] 1.209621098784665
2024-04-21 13:38:15 EarlyStopping counter: 45 out of 50
2024-04-21 13:38:15 53 [train] 0.19301054262807457 [valid] 1.2164585979443225
2024-04-21 13:38:20 EarlyStopping counter: 46 out of 50
2024-04-21 13:38:20 54 [train] 0.1898147996929599 [valid] 1.1950348295878634
2024-04-21 13:38:25 EarlyStopping counter: 47 out of 50
2024-04-21 13:38:25 55 [train] 0.17185109518120403 [valid] 1.2234678905722516
2024-04-21 13:38:30 EarlyStopping counter: 48 out of 50
2024-04-21 13:38:30 56 [train] 0.17133068907580312 [valid] 1.2432351697165658
2024-04-21 13:38:35 EarlyStopping counter: 49 out of 50
2024-04-21 13:38:35 57 [train] 0.17366136391281872 [valid] 1.1979198123841943
2024-04-21 13:38:40 EarlyStopping counter: 50 out of 50
2024-04-21 13:38:40 58 [train] 0.1432349615872095 [valid] 1.2209653398184626
2024-04-21 13:38:40 Early Stopped.
2024-04-21 13:38:40 {'hist': 180, 'hidden': [256, 256], 'dropout': 0.0, 'epochs': 5000, 'batch_size': 50, 'lr': 0.0001, 'l2': 0.0001, 'patience': 50} [0.9446262]
2024-04-21 13:38:40 Saved model's file: ./tmp/lstm_weights/9952857.pt
2024-04-21 13:38:41 0 [train] 1.003604314930164 [valid] 1.2106925136990154
2024-04-21 13:38:46 0 [train] 0.8988936892415477 [valid] 0.9801000586058137
2024-04-21 13:38:51 1 [train] 0.8570155182497476 [valid] 0.9239569437402017
2024-04-21 13:38:56 2 [train] 0.8379438022358269 [valid] 0.8933715833617443
2024-04-21 13:39:01 EarlyStopping counter: 1 out of 50
2024-04-21 13:39:01 3 [train] 0.8361317226693635 [valid] 0.9001648987352316
2024-04-21 13:39:06 EarlyStopping counter: 2 out of 50
2024-04-21 13:39:06 4 [train] 0.816045459402629 [valid] 0.9138251149576168
2024-04-21 13:39:11 EarlyStopping counter: 3 out of 50
2024-04-21 13:39:11 5 [train] 0.7995728639285371 [valid] 0.8971356044185531
2024-04-21 13:39:16 6 [train] 0.7962383550753624 [valid] 0.8828904481463646
2024-04-21 13:39:21 EarlyStopping counter: 1 out of 50
2024-04-21 13:39:21 7 [train] 0.7802303860422104 [valid] 0.8934841181230982
2024-04-21 13:39:26 EarlyStopping counter: 2 out of 50
2024-04-21 13:39:26 8 [train] 0.7791897290420846 [valid] 0.8907676428859593
2024-04-21 13:39:31 EarlyStopping counter: 3 out of 50
2024-04-21 13:39:31 9 [train] 0.7583406600545961 [valid] 0.8987350413978332
2024-04-21 13:39:36 EarlyStopping counter: 4 out of 50
2024-04-21 13:39:36 10 [train] 0.7508778853422068 [valid] 0.925923390637484
2024-04-21 13:39:41 EarlyStopping counter: 5 out of 50
2024-04-21 13:39:41 11 [train] 0.7306583006305929 [valid] 0.9264842203857909
2024-04-21 13:39:46 EarlyStopping counter: 6 out of 50
2024-04-21 13:39:46 12 [train] 0.7278297749384137 [valid] 0.9514076835030844
2024-04-21 13:39:51 EarlyStopping counter: 7 out of 50
2024-04-21 13:39:51 13 [train] 0.7179049349211858 [valid] 0.9206913179112943
2024-04-21 13:39:56 EarlyStopping counter: 8 out of 50
2024-04-21 13:39:56 14 [train] 0.6766832950058256 [valid] 0.9362228745235565
2024-04-21 13:40:01 EarlyStopping counter: 9 out of 50
2024-04-21 13:40:01 15 [train] 0.6802303178566468 [valid] 0.970304131501324
2024-04-21 13:40:06 EarlyStopping counter: 10 out of 50
2024-04-21 13:40:06 16 [train] 0.6380016440303198 [valid] 1.0088971866841863
2024-04-21 13:40:11 EarlyStopping counter: 11 out of 50
2024-04-21 13:40:11 17 [train] 0.5917465042993183 [valid] 1.0566959993692255
2024-04-21 13:40:16 EarlyStopping counter: 12 out of 50
2024-04-21 13:40:16 18 [train] 0.5500136759813533 [valid] 1.0904017485941113
2024-04-21 13:40:21 EarlyStopping counter: 13 out of 50
2024-04-21 13:40:21 19 [train] 0.5154526320511047 [valid] 1.0855624801932486
2024-04-21 13:40:26 EarlyStopping counter: 14 out of 50
2024-04-21 13:40:26 20 [train] 0.4736689382266349 [valid] 1.146957019344206
2024-04-21 13:40:31 EarlyStopping counter: 15 out of 50
2024-04-21 13:40:31 21 [train] 0.417042074143403 [valid] 1.1249170097445598
2024-04-21 13:40:36 EarlyStopping counter: 16 out of 50
2024-04-21 13:40:36 22 [train] 0.372757080864007 [valid] 1.1202433297573644
2024-04-21 13:40:41 EarlyStopping counter: 17 out of 50
2024-04-21 13:40:41 23 [train] 0.3513929033366883 [valid] 1.1198977663912815
2024-04-21 13:40:46 EarlyStopping counter: 18 out of 50
2024-04-21 13:40:46 24 [train] 0.3260726129264771 [valid] 1.193895217681985
2024-04-21 13:40:51 EarlyStopping counter: 19 out of 50
2024-04-21 13:40:51 25 [train] 0.28510916509879786 [valid] 1.1539337106547762
2024-04-21 13:40:56 EarlyStopping counter: 20 out of 50
2024-04-21 13:40:56 26 [train] 0.2691023887206039 [valid] 1.2060858554858351
2024-04-21 13:41:00 EarlyStopping counter: 21 out of 50
2024-04-21 13:41:00 27 [train] 0.22543212271507496 [valid] 1.1712479776965155
2024-04-21 13:41:05 EarlyStopping counter: 22 out of 50
2024-04-21 13:41:05 28 [train] 0.21797489087318625 [valid] 1.2234697304436808
2024-04-21 13:41:10 EarlyStopping counter: 23 out of 50
2024-04-21 13:41:10 29 [train] 0.2683281557359763 [valid] 1.2039332461464904
2024-04-21 13:41:15 EarlyStopping counter: 24 out of 50
2024-04-21 13:41:15 30 [train] 0.16367794951627673 [valid] 1.2487677615573325
2024-04-21 13:41:20 EarlyStopping counter: 25 out of 50
2024-04-21 13:41:20 31 [train] 0.15975223809368447 [valid] 1.2459306012973346
2024-04-21 13:41:25 EarlyStopping counter: 26 out of 50
2024-04-21 13:41:25 32 [train] 0.13888881668559705 [valid] 1.2333505280268158
2024-04-21 13:41:30 EarlyStopping counter: 27 out of 50
2024-04-21 13:41:30 33 [train] 0.1271754270600993 [valid] 1.2178007974840805
2024-04-21 13:41:35 EarlyStopping counter: 28 out of 50
2024-04-21 13:41:35 34 [train] 0.11618385588502625 [valid] 1.2127365091181455
2024-04-21 13:41:40 EarlyStopping counter: 29 out of 50
2024-04-21 13:41:40 35 [train] 0.11154602141552676 [valid] 1.2588701007444925
2024-04-21 13:41:45 EarlyStopping counter: 30 out of 50
2024-04-21 13:41:45 36 [train] 0.11162391352446499 [valid] 1.2714527822253423
2024-04-21 13:41:50 EarlyStopping counter: 31 out of 50
2024-04-21 13:41:50 37 [train] 0.09081669770136147 [valid] 1.2387305828819288
2024-04-21 13:41:55 EarlyStopping counter: 32 out of 50
2024-04-21 13:41:55 38 [train] 0.09926634973013246 [valid] 1.2615800657329825
2024-04-21 13:42:00 EarlyStopping counter: 33 out of 50
2024-04-21 13:42:00 39 [train] 0.0806114895943497 [valid] 1.215881154044076
2024-04-21 13:42:05 EarlyStopping counter: 34 out of 50
2024-04-21 13:42:05 40 [train] 0.07337815256380482 [valid] 1.248998973438612
2024-04-21 13:42:10 EarlyStopping counter: 35 out of 50
2024-04-21 13:42:10 41 [train] 0.0635707986275383 [valid] 1.2337337178447716
2024-04-21 13:42:15 EarlyStopping counter: 36 out of 50
2024-04-21 13:42:15 42 [train] 0.06426152022622718 [valid] 1.2433688447813165
2024-04-21 13:42:20 EarlyStopping counter: 37 out of 50
2024-04-21 13:42:20 43 [train] 0.09438383033446564 [valid] 1.269213959572828
2024-04-21 13:42:25 EarlyStopping counter: 38 out of 50
2024-04-21 13:42:25 44 [train] 0.08219541729767092 [valid] 1.2364193182726324
2024-04-21 13:42:30 EarlyStopping counter: 39 out of 50
2024-04-21 13:42:30 45 [train] 0.04952008833773917 [valid] 1.2411805768565707
2024-04-21 13:42:35 EarlyStopping counter: 40 out of 50
2024-04-21 13:42:35 46 [train] 0.09523295618138793 [valid] 1.2213796953392675
2024-04-21 13:42:40 EarlyStopping counter: 41 out of 50
2024-04-21 13:42:40 47 [train] 0.06773146622427399 [valid] 1.2221171791740926
2024-04-21 13:42:45 EarlyStopping counter: 42 out of 50
2024-04-21 13:42:45 48 [train] 0.07363995866759532 [valid] 1.2656615060335066
2024-04-21 13:42:50 EarlyStopping counter: 43 out of 50
2024-04-21 13:42:50 49 [train] 0.046445144733827715 [valid] 1.2276908041925476
2024-04-21 13:42:55 EarlyStopping counter: 44 out of 50
2024-04-21 13:42:55 50 [train] 0.07307993430125197 [valid] 1.230076939447672
2024-04-21 13:43:00 EarlyStopping counter: 45 out of 50
2024-04-21 13:43:00 51 [train] 0.03992372426695375 [valid] 1.2016182959296813
2024-04-21 13:43:05 EarlyStopping counter: 46 out of 50
2024-04-21 13:43:05 52 [train] 0.04438589855620616 [valid] 1.224873935055017
2024-04-21 13:43:10 EarlyStopping counter: 47 out of 50
2024-04-21 13:43:10 53 [train] 0.04198178264017658 [valid] 1.223582424108338
2024-04-21 13:43:15 EarlyStopping counter: 48 out of 50
2024-04-21 13:43:15 54 [train] 0.06903954830856655 [valid] 1.2102866742863332
2024-04-21 13:43:20 EarlyStopping counter: 49 out of 50
2024-04-21 13:43:20 55 [train] 0.04439107202171187 [valid] 1.2089568502386057
2024-04-21 13:43:25 EarlyStopping counter: 50 out of 50
2024-04-21 13:43:25 56 [train] 0.05828241688184922 [valid] 1.2389515613500577
2024-04-21 13:43:25 Early Stopped.
2024-04-21 13:43:25 {'hist': 180, 'hidden': [256, 256], 'dropout': 0.0, 'epochs': 5000, 'batch_size': 50, 'lr': 0.00031622776601683794, 'l2': 0.0001, 'patience': 50} [0.9396225]
2024-04-21 13:43:25 Saved model's file: ./tmp/lstm_weights/7319186.pt
2024-04-21 13:43:26 0 [train] 1.006216693713988 [valid] 1.2374049755634113
2024-04-21 13:43:31 0 [train] 0.9031730760041203 [valid] 1.002168525428115
2024-04-21 13:43:36 1 [train] 0.8876080297759887 [valid] 0.9222875027898028
2024-04-21 13:43:41 2 [train] 0.8662878778259842 [valid] 0.9162699414114699
2024-04-21 13:43:46 3 [train] 0.8333279274594534 [valid] 0.8967150007443004
2024-04-21 13:43:51 EarlyStopping counter: 1 out of 50
2024-04-21 13:43:51 4 [train] 0.8141517228040495 [valid] 0.9093430863842359
2024-04-21 13:43:56 EarlyStopping counter: 2 out of 50
2024-04-21 13:43:56 5 [train] 0.8112607084154725 [valid] 0.8987473636064699
2024-04-21 13:44:01 6 [train] 0.7860055999571067 [valid] 0.8835152990888684
2024-04-21 13:44:06 EarlyStopping counter: 1 out of 50
2024-04-21 13:44:06 7 [train] 0.7789614845023073 [valid] 0.9056037386113729
2024-04-21 13:44:11 EarlyStopping counter: 2 out of 50
2024-04-21 13:44:11 8 [train] 0.7622385880785209 [valid] 0.9103606529688245
2024-04-21 13:44:16 EarlyStopping counter: 3 out of 50
2024-04-21 13:44:16 9 [train] 0.7472082497359687 [valid] 0.8994402587675769
2024-04-21 13:44:21 10 [train] 0.7361802396873623 [valid] 0.8813632985264246
2024-04-21 13:44:26 EarlyStopping counter: 1 out of 50
2024-04-21 13:44:26 11 [train] 0.7281283522375438 [valid] 0.950622552117181
2024-04-21 13:44:31 EarlyStopping counter: 2 out of 50
2024-04-21 13:44:31 12 [train] 0.6916692377778176 [valid] 0.9171400495920516
2024-04-21 13:44:36 EarlyStopping counter: 3 out of 50
2024-04-21 13:44:36 13 [train] 0.6733886747189308 [valid] 0.9885646978054725
2024-04-21 13:44:41 EarlyStopping counter: 4 out of 50
2024-04-21 13:44:41 14 [train] 0.6497959165054462 [valid] 0.9784188790303685
2024-04-21 13:44:46 EarlyStopping counter: 5 out of 50
2024-04-21 13:44:46 15 [train] 0.6025724122841675 [valid] 0.9897073819610203
2024-04-21 13:44:50 EarlyStopping counter: 6 out of 50
2024-04-21 13:44:50 16 [train] 0.5851311628854885 [valid] 1.0403757552869743
2024-04-21 13:44:55 EarlyStopping counter: 7 out of 50
2024-04-21 13:44:55 17 [train] 0.5442683137790731 [valid] 1.027557644441501
2024-04-21 13:45:00 EarlyStopping counter: 8 out of 50
2024-04-21 13:45:00 18 [train] 0.5237137259898433 [valid] 1.0397041528578697
2024-04-21 13:45:05 EarlyStopping counter: 9 out of 50
2024-04-21 13:45:05 19 [train] 0.4921568417106804 [valid] 1.0520841937975773
2024-04-21 13:45:10 EarlyStopping counter: 10 out of 50
2024-04-21 13:45:10 20 [train] 0.4690380404524845 [valid] 1.0909735352871301
2024-04-21 13:45:15 EarlyStopping counter: 11 out of 50
2024-04-21 13:45:15 21 [train] 0.42563506041532834 [valid] 1.1431078914149193
2024-04-21 13:45:20 EarlyStopping counter: 12 out of 50
2024-04-21 13:45:20 22 [train] 0.3981017757791975 [valid] 1.1151828772268986
2024-04-21 13:45:25 EarlyStopping counter: 13 out of 50
2024-04-21 13:45:25 23 [train] 0.3933878822024042 [valid] 1.1174400845271446
2024-04-21 13:45:30 EarlyStopping counter: 14 out of 50
2024-04-21 13:45:30 24 [train] 0.35428736623609114 [valid] 1.1979573741807839
2024-04-21 13:45:35 EarlyStopping counter: 15 out of 50
2024-04-21 13:45:35 25 [train] 0.3298547708311788 [valid] 1.1325401125687924
2024-04-21 13:45:40 EarlyStopping counter: 16 out of 50
2024-04-21 13:45:40 26 [train] 0.3379112704569693 [valid] 1.246734180708155
2024-04-21 13:45:45 EarlyStopping counter: 17 out of 50
2024-04-21 13:45:45 27 [train] 0.2951034656035738 [valid] 1.2121114797078978
2024-04-21 13:45:50 EarlyStopping counter: 18 out of 50
2024-04-21 13:45:50 28 [train] 0.2731802989057627 [valid] 1.254385262768906
2024-04-21 13:45:55 EarlyStopping counter: 19 out of 50
2024-04-21 13:45:55 29 [train] 0.26204296456346293 [valid] 1.2004643314135939
2024-04-21 13:46:00 EarlyStopping counter: 20 out of 50
2024-04-21 13:46:00 30 [train] 0.24736841101859341 [valid] 1.2464178023469459
2024-04-21 13:46:05 EarlyStopping counter: 21 out of 50
2024-04-21 13:46:05 31 [train] 0.23859570324353502 [valid] 1.2118050624145928
2024-04-21 13:46:10 EarlyStopping counter: 22 out of 50
2024-04-21 13:46:10 32 [train] 0.20723551533437892 [valid] 1.256723363686488
2024-04-21 13:46:15 EarlyStopping counter: 23 out of 50
2024-04-21 13:46:15 33 [train] 0.2558438316699918 [valid] 1.2198151468193952
2024-04-21 13:46:20 EarlyStopping counter: 24 out of 50
2024-04-21 13:46:20 34 [train] 0.2166731029473424 [valid] 1.2424270774657802
2024-04-21 13:46:25 EarlyStopping counter: 25 out of 50
2024-04-21 13:46:25 35 [train] 0.18145164047626777 [valid] 1.2515568090610942
2024-04-21 13:46:30 EarlyStopping counter: 26 out of 50
2024-04-21 13:46:30 36 [train] 0.17577231571835905 [valid] 1.2377473472628209
2024-04-21 13:46:35 EarlyStopping counter: 27 out of 50
2024-04-21 13:46:35 37 [train] 0.1696139405162407 [valid] 1.261706908051129
2024-04-21 13:46:40 EarlyStopping counter: 28 out of 50
2024-04-21 13:46:40 38 [train] 0.15952043690587134 [valid] 1.2633535649501602
2024-04-21 13:46:45 EarlyStopping counter: 29 out of 50
2024-04-21 13:46:45 39 [train] 0.15937574520505327 [valid] 1.225660819489648
2024-04-21 13:46:50 EarlyStopping counter: 30 out of 50
2024-04-21 13:46:50 40 [train] 0.17904725875844552 [valid] 1.2926081891644021
2024-04-21 13:46:55 EarlyStopping counter: 31 out of 50
2024-04-21 13:46:55 41 [train] 0.15681031393159656 [valid] 1.2888275632925044
2024-04-21 13:47:00 EarlyStopping counter: 32 out of 50
2024-04-21 13:47:00 42 [train] 0.1476316460977467 [valid] 1.2913268818098382
2024-04-21 13:47:05 EarlyStopping counter: 33 out of 50
2024-04-21 13:47:05 43 [train] 0.14078162294774 [valid] 1.2675879912042265
2024-04-21 13:47:10 EarlyStopping counter: 34 out of 50
2024-04-21 13:47:10 44 [train] 0.17517694492019362 [valid] 1.2469898470753809
2024-04-21 13:47:15 EarlyStopping counter: 35 out of 50
2024-04-21 13:47:15 45 [train] 0.1235190953609881 [valid] 1.2627953996456824
2024-04-21 13:47:20 EarlyStopping counter: 36 out of 50
2024-04-21 13:47:20 46 [train] 0.12971005594368865 [valid] 1.2860468297796335
2024-04-21 13:47:25 EarlyStopping counter: 37 out of 50
2024-04-21 13:47:25 47 [train] 0.13318886023752038 [valid] 1.2634271472714946
2024-04-21 13:47:30 EarlyStopping counter: 38 out of 50
2024-04-21 13:47:30 48 [train] 0.1335261684773083 [valid] 1.2479773900526245
2024-04-21 13:47:35 EarlyStopping counter: 39 out of 50
2024-04-21 13:47:35 49 [train] 0.1262079781436865 [valid] 1.2423953112590467
2024-04-21 13:47:40 EarlyStopping counter: 40 out of 50
2024-04-21 13:47:40 50 [train] 0.1320672108072303 [valid] 1.2948105671957302
2024-04-21 13:47:45 EarlyStopping counter: 41 out of 50
2024-04-21 13:47:45 51 [train] 0.11066136849463948 [valid] 1.2794629698061366
2024-04-21 13:47:50 EarlyStopping counter: 42 out of 50
2024-04-21 13:47:50 52 [train] 0.14203926280563267 [valid] 1.3095252735372556
2024-04-21 13:47:55 EarlyStopping counter: 43 out of 50
2024-04-21 13:47:55 53 [train] 0.12561945894702306 [valid] 1.2457284108150488
2024-04-21 13:48:00 EarlyStopping counter: 44 out of 50
2024-04-21 13:48:00 54 [train] 0.102921186302483 [valid] 1.2704017329130672
2024-04-21 13:48:05 EarlyStopping counter: 45 out of 50
2024-04-21 13:48:05 55 [train] 0.10364242085666904 [valid] 1.2598777771273046
2024-04-21 13:48:10 EarlyStopping counter: 46 out of 50
2024-04-21 13:48:10 56 [train] 0.11057560429631548 [valid] 1.3140980184160553
2024-04-21 13:48:15 EarlyStopping counter: 47 out of 50
2024-04-21 13:48:15 57 [train] 0.10752406102990499 [valid] 1.2844120120262659
2024-04-21 13:48:20 EarlyStopping counter: 48 out of 50
2024-04-21 13:48:20 58 [train] 0.18569489701161068 [valid] 1.2352085071084309
2024-04-21 13:48:25 EarlyStopping counter: 49 out of 50
2024-04-21 13:48:25 59 [train] 0.103110368818429 [valid] 1.2875112875852546
2024-04-21 13:48:30 EarlyStopping counter: 50 out of 50
2024-04-21 13:48:30 60 [train] 0.11076306735003379 [valid] 1.2717438164172603
2024-04-21 13:48:30 Early Stopped.
2024-04-21 13:48:30 {'hist': 180, 'hidden': [256, 256], 'dropout': 0.0, 'epochs': 5000, 'batch_size': 50, 'lr': 0.001, 'l2': 0.0001, 'patience': 50} [0.9388095]
2024-04-21 13:48:30 Saved model's file: ./tmp/lstm_weights/3854389.pt
2024-04-21 13:48:31 0 [train] 1.0026467159246442 [valid] 1.2308382829140139
2024-04-21 13:48:36 0 [train] 0.9209370829099721 [valid] 0.9469981920673487
2024-04-21 13:48:41 EarlyStopping counter: 1 out of 50
2024-04-21 13:48:41 1 [train] 0.8821631783595502 [valid] 0.9687861466765568
2024-04-21 13:48:46 2 [train] 0.8438073323397867 [valid] 0.8802565152503191
2024-04-21 13:48:51 EarlyStopping counter: 1 out of 50
2024-04-21 13:48:51 3 [train] 0.8262750253670356 [valid] 0.8805391500920009
2024-04-21 13:48:56 EarlyStopping counter: 2 out of 50
2024-04-21 13:48:56 4 [train] 0.8186713261950929 [valid] 0.9059616505601935
2024-04-21 13:49:01 5 [train] 0.8011410953371367 [valid] 0.8754246517076469
2024-04-21 13:49:06 EarlyStopping counter: 1 out of 50
2024-04-21 13:49:06 6 [train] 0.8094218695403386 [valid] 0.8777449918511104
2024-04-21 13:49:11 EarlyStopping counter: 2 out of 50
2024-04-21 13:49:11 7 [train] 0.7868232033628311 [valid] 0.8839606942374338
2024-04-21 13:49:16 EarlyStopping counter: 3 out of 50
2024-04-21 13:49:16 8 [train] 0.784259649273258 [valid] 0.9011695423528027
2024-04-21 13:49:21 9 [train] 0.7774964494535512 [valid] 0.8680952136261775
2024-04-21 13:49:26 EarlyStopping counter: 1 out of 50
2024-04-21 13:49:26 10 [train] 0.7609480460107224 [valid] 0.8987427327183568
2024-04-21 13:49:31 EarlyStopping counter: 2 out of 50
2024-04-21 13:49:31 11 [train] 0.7604655238333984 [valid] 0.8979649534199865
2024-04-21 13:49:36 EarlyStopping counter: 3 out of 50
2024-04-21 13:49:36 12 [train] 0.7414594556342932 [valid] 0.9180579306783501
2024-04-21 13:49:41 EarlyStopping counter: 4 out of 50
2024-04-21 13:49:41 13 [train] 0.7202848502240603 [valid] 0.9248884990745853
2024-04-21 13:49:46 EarlyStopping counter: 5 out of 50
2024-04-21 13:49:46 14 [train] 0.7252210018878616 [valid] 0.9508016567860179
2024-04-21 13:49:51 EarlyStopping counter: 6 out of 50
2024-04-21 13:49:51 15 [train] 0.6774148283460498 [valid] 0.9509838933522088
2024-04-21 13:49:56 EarlyStopping counter: 7 out of 50
2024-04-21 13:49:56 16 [train] 0.646773000117044 [valid] 0.9762002651930664
2024-04-21 13:50:01 EarlyStopping counter: 8 out of 50
2024-04-21 13:50:01 17 [train] 0.6212398061981113 [valid] 1.0235208370933937
2024-04-21 13:50:06 EarlyStopping counter: 9 out of 50
2024-04-21 13:50:06 18 [train] 0.597710891897301 [valid] 1.0013909895213033
2024-04-21 13:50:11 EarlyStopping counter: 10 out of 50
2024-04-21 13:50:11 19 [train] 0.56382701415456 [valid] 1.1005582202660533
2024-04-21 13:50:16 EarlyStopping counter: 11 out of 50
2024-04-21 13:50:16 20 [train] 0.512272028452058 [valid] 1.0816385756032365
2024-04-21 13:50:21 EarlyStopping counter: 12 out of 50
2024-04-21 13:50:21 21 [train] 0.49624574654729753 [valid] 1.1190330834244568
2024-04-21 13:50:26 EarlyStopping counter: 13 out of 50
2024-04-21 13:50:26 22 [train] 0.45331658171343236 [valid] 1.1304171175629174
2024-04-21 13:50:31 EarlyStopping counter: 14 out of 50
2024-04-21 13:50:31 23 [train] 0.4311333124058453 [valid] 1.1650461347074974
2024-04-21 13:50:36 EarlyStopping counter: 15 out of 50
2024-04-21 13:50:36 24 [train] 0.3990626178864629 [valid] 1.2365915579748232
2024-04-21 13:50:41 EarlyStopping counter: 16 out of 50
2024-04-21 13:50:41 25 [train] 0.34322154784767817 [valid] 1.1945953877516673
2024-04-21 13:50:46 EarlyStopping counter: 17 out of 50
2024-04-21 13:50:46 26 [train] 0.3246570150412918 [valid] 1.2251653359618362
2024-04-21 13:50:51 EarlyStopping counter: 18 out of 50
2024-04-21 13:50:51 27 [train] 0.2935904660094951 [valid] 1.2445709792480506
2024-04-21 13:50:56 EarlyStopping counter: 19 out of 50
2024-04-21 13:50:56 28 [train] 0.29197855636936465 [valid] 1.2490001659263517
2024-04-21 13:51:01 EarlyStopping counter: 20 out of 50
2024-04-21 13:51:01 29 [train] 0.25290699397429317 [valid] 1.2438553908722163
2024-04-21 13:51:06 EarlyStopping counter: 21 out of 50
2024-04-21 13:51:06 30 [train] 0.22782854373135475 [valid] 1.2867144375017776
2024-04-21 13:51:11 EarlyStopping counter: 22 out of 50
2024-04-21 13:51:11 31 [train] 0.2308337107017078 [valid] 1.2615267562253174
2024-04-21 13:51:16 EarlyStopping counter: 23 out of 50
2024-04-21 13:51:16 32 [train] 0.2083805819308158 [valid] 1.2628212535570693
2024-04-21 13:51:21 EarlyStopping counter: 24 out of 50
2024-04-21 13:51:21 33 [train] 0.1879321523650095 [valid] 1.2500232338837967
2024-04-21 13:51:26 EarlyStopping counter: 25 out of 50
2024-04-21 13:51:26 34 [train] 0.18216045969434522 [valid] 1.2470444698220264
2024-04-21 13:51:31 EarlyStopping counter: 26 out of 50
2024-04-21 13:51:31 35 [train] 0.16195967161806465 [valid] 1.318252952894074
2024-04-21 13:51:36 EarlyStopping counter: 27 out of 50
2024-04-21 13:51:36 36 [train] 0.1547822499552434 [valid] 1.2507145039762486
2024-04-21 13:51:41 EarlyStopping counter: 28 out of 50
2024-04-21 13:51:41 37 [train] 0.1951244898361258 [valid] 1.2714972053358007
2024-04-21 13:51:46 EarlyStopping counter: 29 out of 50
2024-04-21 13:51:46 38 [train] 0.13813509416779018 [valid] 1.264430557215886
2024-04-21 13:51:51 EarlyStopping counter: 30 out of 50
2024-04-21 13:51:51 39 [train] 0.12994787849259748 [valid] 1.2993239782105943
2024-04-21 13:51:56 EarlyStopping counter: 31 out of 50
2024-04-21 13:51:56 40 [train] 0.11900158012284925 [valid] 1.305021754322258
2024-04-21 13:52:01 EarlyStopping counter: 32 out of 50
2024-04-21 13:52:01 41 [train] 0.10947212974861384 [valid] 1.2533385964115407
2024-04-21 13:52:06 EarlyStopping counter: 33 out of 50
2024-04-21 13:52:06 42 [train] 0.10710282813265311 [valid] 1.2891665547992601
2024-04-21 13:52:11 EarlyStopping counter: 34 out of 50
2024-04-21 13:52:11 43 [train] 0.10312255197174698 [valid] 1.2662081074605376
2024-04-21 13:52:16 EarlyStopping counter: 35 out of 50
2024-04-21 13:52:16 44 [train] 0.08667081859309668 [valid] 1.2866533748860727
2024-04-21 13:52:21 EarlyStopping counter: 36 out of 50
2024-04-21 13:52:21 45 [train] 0.12579069682196017 [valid] 1.2460741086490008
2024-04-21 13:52:26 EarlyStopping counter: 37 out of 50
2024-04-21 13:52:26 46 [train] 0.11456212112640644 [valid] 1.2824066909401768
2024-04-21 13:52:31 EarlyStopping counter: 38 out of 50
2024-04-21 13:52:31 47 [train] 0.11320500301340516 [valid] 1.34712739258679
2024-04-21 13:52:36 EarlyStopping counter: 39 out of 50
2024-04-21 13:52:36 48 [train] 0.08055303859283583 [valid] 1.2672031305736893
2024-04-21 13:52:40 EarlyStopping counter: 40 out of 50
2024-04-21 13:52:40 49 [train] 0.09066375059119994 [valid] 1.2593151564935217
2024-04-21 13:52:45 EarlyStopping counter: 41 out of 50
2024-04-21 13:52:45 50 [train] 0.07193763671746474 [valid] 1.2668012303801828
2024-04-21 13:52:49 EarlyStopping counter: 42 out of 50
2024-04-21 13:52:49 51 [train] 0.08131160619215178 [valid] 1.2584607467554958
2024-04-21 13:52:53 EarlyStopping counter: 43 out of 50
2024-04-21 13:52:53 52 [train] 0.06632895808236006 [valid] 1.2562877471035605
2024-04-21 13:52:58 EarlyStopping counter: 44 out of 50
2024-04-21 13:52:58 53 [train] 0.06604570553072517 [valid] 1.260071924549243
2024-04-21 13:53:02 EarlyStopping counter: 45 out of 50
2024-04-21 13:53:02 54 [train] 0.07993939106014794 [valid] 1.2556265761104344
2024-04-21 13:53:07 EarlyStopping counter: 46 out of 50
2024-04-21 13:53:07 55 [train] 0.07003904574889425 [valid] 1.2848040125267628
2024-04-21 13:53:11 EarlyStopping counter: 47 out of 50
2024-04-21 13:53:11 56 [train] 0.06931438335377106 [valid] 1.2912458123857466
2024-04-21 13:53:15 EarlyStopping counter: 48 out of 50
2024-04-21 13:53:15 57 [train] 0.06323826722789895 [valid] 1.2349022838296295
2024-04-21 13:53:20 EarlyStopping counter: 49 out of 50
2024-04-21 13:53:20 58 [train] 0.07198416534356719 [valid] 1.2474657053640854
2024-04-21 13:53:24 EarlyStopping counter: 50 out of 50
2024-04-21 13:53:24 59 [train] 0.0685306275698401 [valid] 1.2562069049413578
2024-04-21 13:53:24 Early Stopped.
