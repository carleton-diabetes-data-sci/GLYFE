2024-04-21 11:20:19 tidepool fa6d lstm lstm FIRST_TIDEPOOL test None 120 1
             datetime  glucose  CHO  insulin
0 2015-09-07 17:00:00    104.0  NaN      NaN
1 2015-09-07 17:05:00     99.0  NaN      NaN
2 2015-09-07 17:10:00     96.0  NaN      NaN
3 2015-09-07 17:15:00     94.0  NaN      NaN
4 2015-09-07 17:20:00     94.0  NaN      NaN
Printing heads of split dataset
Train
               datetime   time  glucose_0  ...  insulin_34  insulin_35     y
100 2015-09-08 08:20:00  100.0      104.0  ...         0.0         0.0  98.0
101 2015-09-08 08:25:00  101.0      103.0  ...         0.0         0.0  96.0
102 2015-09-08 08:30:00  102.0      104.0  ...         0.0         0.0  84.0
103 2015-09-08 08:35:00  103.0      106.0  ...         0.0         0.0  85.0
104 2015-09-08 08:40:00  104.0      107.0  ...         0.0         0.0  90.0
105 2015-09-08 08:45:00  105.0      109.0  ...         0.0         0.0  88.0
106 2015-09-08 08:50:00  106.0      111.0  ...         0.0         0.0  85.0
107 2015-09-08 08:55:00  107.0      111.0  ...         0.0         0.0  78.0
108 2015-09-08 09:00:00  108.0      113.0  ...         0.0         0.0  78.0
109 2015-09-08 09:05:00  109.0      116.0  ...         0.0         0.0  82.0

[10 rows x 111 columns]
Valid
               datetime   time  glucose_0  ...  insulin_34  insulin_35      y
100 2015-09-10 08:20:00  100.0      151.0  ...         0.0         0.0  113.0
101 2015-09-10 08:25:00  101.0      146.0  ...         0.0         0.0  116.0
102 2015-09-10 08:30:00  102.0      141.0  ...         0.0         0.0  141.0
103 2015-09-10 08:35:00  103.0      133.0  ...         0.0         0.0  133.0
104 2015-09-10 08:40:00  104.0      129.0  ...         0.0         0.0  133.0
105 2015-09-10 08:45:00  105.0      125.0  ...         0.0         0.0  133.0
106 2015-09-10 08:50:00  106.0      121.0  ...         0.0         0.0  146.0
107 2015-09-10 08:55:00  107.0      116.0  ...         0.0         0.0  152.0
108 2015-09-10 09:00:00  108.0      113.0  ...         0.0         0.0  156.0
109 2015-09-10 09:05:00  109.0      110.0  ...         0.0         0.0  162.0

[10 rows x 111 columns]
Test
                  datetime   time  glucose_0  ...  insulin_34  insulin_35      y
265577 2018-03-17 08:20:00  100.0      126.0  ...         0.0         0.0  134.0
265578 2018-03-17 08:25:00  101.0      126.0  ...         0.0         0.0  135.0
265579 2018-03-17 08:30:00  102.0      128.0  ...         0.0         0.0  133.0
265580 2018-03-17 08:35:00  103.0      131.0  ...         0.0         0.0  131.0
265581 2018-03-17 08:40:00  104.0      132.0  ...         0.0         0.0  127.0
265582 2018-03-17 08:45:00  105.0      129.0  ...         0.0         0.0  121.0
265583 2018-03-17 08:50:00  106.0      128.0  ...         0.0         0.0  119.0
265584 2018-03-17 08:55:00  107.0      128.0  ...         0.0         0.0  114.0
265585 2018-03-17 09:00:00  108.0      128.0  ...         0.0         0.0  108.0
265586 2018-03-17 09:05:00  109.0      127.0  ...         0.0         0.0  105.0

[10 rows x 111 columns]
2024-04-21 11:22:47 Saved model's file: ./tmp/lstm_weights/1465220.pt
2024-04-21 11:22:52 0 [train] 1.000287026149798 [valid] 0.9244612498915185
2024-04-21 11:23:08 0 [train] 0.8771074169347703 [valid] 0.8300404642715697
2024-04-21 11:23:23 1 [train] 0.866850983071535 [valid] 0.8202433106961916
2024-04-21 11:23:39 2 [train] 0.8613882363877079 [valid] 0.8136426081347558
2024-04-21 11:23:55 EarlyStopping counter: 1 out of 50
2024-04-21 11:23:55 3 [train] 0.8554355943235422 [valid] 0.8144109830249953
2024-04-21 11:24:11 4 [train] 0.8540411979719925 [valid] 0.812073825794282
2024-04-21 11:24:27 5 [train] 0.8520326505599136 [valid] 0.8050646759082183
2024-04-21 11:24:43 EarlyStopping counter: 1 out of 50
2024-04-21 11:24:43 6 [train] 0.8464716585030242 [valid] 0.8104844591920947
2024-04-21 11:24:59 EarlyStopping counter: 2 out of 50
2024-04-21 11:24:59 7 [train] 0.8443913462278538 [valid] 0.812705579929413
2024-04-21 11:25:15 EarlyStopping counter: 3 out of 50
2024-04-21 11:25:15 8 [train] 0.8392088292445455 [valid] 0.8054331511533415
2024-04-21 11:25:31 EarlyStopping counter: 4 out of 50
2024-04-21 11:25:31 9 [train] 0.8371365938326447 [valid] 0.8090340581444257
2024-04-21 11:25:47 EarlyStopping counter: 5 out of 50
2024-04-21 11:25:47 10 [train] 0.8364447435933066 [valid] 0.8242397936888641
2024-04-21 11:26:03 EarlyStopping counter: 6 out of 50
2024-04-21 11:26:03 11 [train] 0.8300609126937493 [valid] 0.8125589526205219
2024-04-21 11:26:19 EarlyStopping counter: 7 out of 50
2024-04-21 11:26:19 12 [train] 0.8243261292359839 [valid] 0.8173992301069262
2024-04-21 11:26:35 EarlyStopping counter: 8 out of 50
2024-04-21 11:26:35 13 [train] 0.8201697769616476 [valid] 0.8130881494517894
2024-04-21 11:26:51 EarlyStopping counter: 9 out of 50
2024-04-21 11:26:51 14 [train] 0.8181346385775724 [valid] 0.8152383483011959
2024-04-21 11:27:07 EarlyStopping counter: 10 out of 50
2024-04-21 11:27:07 15 [train] 0.8127615544249586 [valid] 0.8170470626495456
2024-04-21 11:27:23 EarlyStopping counter: 11 out of 50
2024-04-21 11:27:23 16 [train] 0.8065771702818886 [valid] 0.8212054191878275
2024-04-21 11:27:39 EarlyStopping counter: 12 out of 50
2024-04-21 11:27:39 17 [train] 0.8020637122924382 [valid] 0.8254935888799007
2024-04-21 11:27:55 EarlyStopping counter: 13 out of 50
2024-04-21 11:27:55 18 [train] 0.7957518260471174 [valid] 0.8236470094943806
2024-04-21 11:28:11 EarlyStopping counter: 14 out of 50
2024-04-21 11:28:11 19 [train] 0.787252386359057 [valid] 0.8315183681762303
2024-04-21 11:28:27 EarlyStopping counter: 15 out of 50
2024-04-21 11:28:27 20 [train] 0.7775789405283053 [valid] 0.8333860201724069
2024-04-21 11:28:43 EarlyStopping counter: 16 out of 50
2024-04-21 11:28:43 21 [train] 0.7682947548831452 [valid] 0.8472308313014436
2024-04-21 11:28:59 EarlyStopping counter: 17 out of 50
2024-04-21 11:28:59 22 [train] 0.7563425085211932 [valid] 0.860206507897095
2024-04-21 11:29:15 EarlyStopping counter: 18 out of 50
2024-04-21 11:29:15 23 [train] 0.7440617148583786 [valid] 0.8576261241707627
2024-04-21 11:29:31 EarlyStopping counter: 19 out of 50
2024-04-21 11:29:31 24 [train] 0.7285324065498255 [valid] 0.8647686647879751
2024-04-21 11:29:47 EarlyStopping counter: 20 out of 50
2024-04-21 11:29:47 25 [train] 0.7108406336089667 [valid] 0.8873846080103664
2024-04-21 11:30:03 EarlyStopping counter: 21 out of 50
2024-04-21 11:30:03 26 [train] 0.6881511419899138 [valid] 0.8858316850953677
2024-04-21 11:30:19 EarlyStopping counter: 22 out of 50
2024-04-21 11:30:19 27 [train] 0.6782402190965506 [valid] 0.9037606060345621
2024-04-21 11:30:35 EarlyStopping counter: 23 out of 50
2024-04-21 11:30:35 28 [train] 0.6558270832847037 [valid] 0.9187726765387273
2024-04-21 11:30:51 EarlyStopping counter: 24 out of 50
2024-04-21 11:30:51 29 [train] 0.6326716821675616 [valid] 0.9291633284913188
2024-04-21 11:31:07 EarlyStopping counter: 25 out of 50
2024-04-21 11:31:07 30 [train] 0.6205057784670481 [valid] 0.969069839824748
2024-04-21 11:31:23 EarlyStopping counter: 26 out of 50
2024-04-21 11:31:23 31 [train] 0.5858361196359269 [valid] 0.9482604196865017
2024-04-21 11:31:39 EarlyStopping counter: 27 out of 50
2024-04-21 11:31:39 32 [train] 0.5816562327326313 [valid] 0.9793260882325684
2024-04-21 11:31:55 EarlyStopping counter: 28 out of 50
2024-04-21 11:31:55 33 [train] 0.544343488811747 [valid] 1.0029085100428676
2024-04-21 11:32:11 EarlyStopping counter: 29 out of 50
2024-04-21 11:32:11 34 [train] 0.5160098430862872 [valid] 1.0078173296753397
2024-04-21 11:32:27 EarlyStopping counter: 30 out of 50
2024-04-21 11:32:27 35 [train] 0.502768925170907 [valid] 1.028407498711845
2024-04-21 11:32:43 EarlyStopping counter: 31 out of 50
2024-04-21 11:32:43 36 [train] 0.48453401791565043 [valid] 1.0874912669242613
2024-04-21 11:32:59 EarlyStopping counter: 32 out of 50
2024-04-21 11:32:59 37 [train] 0.4550266525726815 [valid] 1.0595386932565944
2024-04-21 11:33:15 EarlyStopping counter: 33 out of 50
2024-04-21 11:33:15 38 [train] 0.4345436922317767 [valid] 1.0887690563815708
2024-04-21 11:33:31 EarlyStopping counter: 34 out of 50
2024-04-21 11:33:31 39 [train] 0.4135611502120769 [valid] 1.0797774343488005
2024-04-21 11:33:47 EarlyStopping counter: 35 out of 50
2024-04-21 11:33:47 40 [train] 0.39076299312927865 [valid] 1.0992525189209372
2024-04-21 11:34:03 EarlyStopping counter: 36 out of 50
2024-04-21 11:34:03 41 [train] 0.36377133209680407 [valid] 1.1313323827264428
2024-04-21 11:34:19 EarlyStopping counter: 37 out of 50
2024-04-21 11:34:19 42 [train] 0.3476741988980038 [valid] 1.1366625567373634
2024-04-21 11:34:35 EarlyStopping counter: 38 out of 50
2024-04-21 11:34:35 43 [train] 0.3295460829588362 [valid] 1.1534168139243142
2024-04-21 11:34:51 EarlyStopping counter: 39 out of 50
2024-04-21 11:34:51 44 [train] 0.31610323588628947 [valid] 1.1520569668239289
2024-04-21 11:35:07 EarlyStopping counter: 40 out of 50
2024-04-21 11:35:07 45 [train] 0.2923974268724698 [valid] 1.168940456317319
2024-04-21 11:35:23 EarlyStopping counter: 41 out of 50
2024-04-21 11:35:23 46 [train] 0.27963473796851923 [valid] 1.1717546010098812
2024-04-21 11:35:39 EarlyStopping counter: 42 out of 50
2024-04-21 11:35:39 47 [train] 0.27745947214952643 [valid] 1.200776719969121
2024-04-21 11:35:55 EarlyStopping counter: 43 out of 50
2024-04-21 11:35:55 48 [train] 0.2569101942162192 [valid] 1.1746972530186441
2024-04-21 11:36:11 EarlyStopping counter: 44 out of 50
2024-04-21 11:36:11 49 [train] 0.24016359629287612 [valid] 1.2053510867598316
2024-04-21 11:36:27 EarlyStopping counter: 45 out of 50
2024-04-21 11:36:27 50 [train] 0.23888430029010183 [valid] 1.2252645428423998
2024-04-21 11:36:43 EarlyStopping counter: 46 out of 50
2024-04-21 11:36:43 51 [train] 0.2240989489770509 [valid] 1.1993900745632176
2024-04-21 11:37:00 EarlyStopping counter: 47 out of 50
2024-04-21 11:37:00 52 [train] 0.21960682327532166 [valid] 1.2315462714762284
2024-04-21 11:37:16 EarlyStopping counter: 48 out of 50
2024-04-21 11:37:16 53 [train] 0.19961600781850541 [valid] 1.23051310995894
2024-04-21 11:37:32 EarlyStopping counter: 49 out of 50
2024-04-21 11:37:32 54 [train] 0.19857707682184725 [valid] 1.2416606162852915
2024-04-21 11:37:48 EarlyStopping counter: 50 out of 50
2024-04-21 11:37:48 55 [train] 0.18402410054971646 [valid] 1.2253744015861925
2024-04-21 11:37:48 Early Stopped.
