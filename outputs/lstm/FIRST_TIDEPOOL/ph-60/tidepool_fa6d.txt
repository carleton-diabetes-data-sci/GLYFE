2024-04-21 10:57:26 tidepool fa6d lstm lstm FIRST_TIDEPOOL test None 60 1
             datetime  glucose  CHO  insulin
0 2015-09-07 17:00:00    104.0  NaN      NaN
1 2015-09-07 17:05:00     99.0  NaN      NaN
2 2015-09-07 17:10:00     96.0  NaN      NaN
3 2015-09-07 17:15:00     94.0  NaN      NaN
4 2015-09-07 17:20:00     94.0  NaN      NaN
Printing heads of split dataset
Train
               datetime   time  glucose_0  ...  insulin_34  insulin_35     y
100 2015-09-08 08:20:00  100.0      127.0  ...         0.0         0.0  98.0
101 2015-09-08 08:25:00  101.0      133.0  ...         0.0         0.0  96.0
102 2015-09-08 08:30:00  102.0      140.0  ...         0.0         0.0  84.0
103 2015-09-08 08:35:00  103.0      146.0  ...         0.0         0.0  85.0
104 2015-09-08 08:40:00  104.0      152.0  ...         0.0         0.0  90.0
105 2015-09-08 08:45:00  105.0      158.0  ...         0.0         0.0  88.0
106 2015-09-08 08:50:00  106.0      167.0  ...         0.0         0.0  85.0
107 2015-09-08 08:55:00  107.0      171.0  ...         0.0         0.0  78.0
108 2015-09-08 09:00:00  108.0      172.0  ...         0.0         0.0  78.0
109 2015-09-08 09:05:00  109.0      173.0  ...         0.0         0.0  82.0

[10 rows x 111 columns]
Valid
               datetime   time  glucose_0  ...  insulin_34  insulin_35      y
100 2015-09-10 08:20:00  100.0      101.0  ...         0.0         0.0  113.0
101 2015-09-10 08:25:00  101.0       99.0  ...         0.0         0.0  116.0
102 2015-09-10 08:30:00  102.0       97.0  ...         0.0         0.0  141.0
103 2015-09-10 08:35:00  103.0       97.0  ...         0.0         0.0  133.0
104 2015-09-10 08:40:00  104.0       98.0  ...         0.0         0.0  133.0
105 2015-09-10 08:45:00  105.0       97.0  ...         0.0         0.0  133.0
106 2015-09-10 08:50:00  106.0       96.0  ...         0.0         0.0  146.0
107 2015-09-10 08:55:00  107.0       91.0  ...         0.0         0.0  152.0
108 2015-09-10 09:00:00  108.0       91.0  ...         0.0         0.0  156.0
109 2015-09-10 09:05:00  109.0       89.0  ...         0.0         0.0  162.0

[10 rows x 111 columns]
Test
                  datetime   time  glucose_0  ...  insulin_34  insulin_35      y
265589 2018-03-17 08:20:00  100.0      131.0  ...         0.0         0.0  134.0
265590 2018-03-17 08:25:00  101.0      129.0  ...         0.0         0.0  135.0
265591 2018-03-17 08:30:00  102.0      127.0  ...         0.0         0.0  133.0
265592 2018-03-17 08:35:00  103.0      126.0  ...         0.0         0.0  131.0
265593 2018-03-17 08:40:00  104.0      125.0  ...         0.0         0.0  127.0
265594 2018-03-17 08:45:00  105.0      127.0  ...         0.0         0.0  121.0
265595 2018-03-17 08:50:00  106.0      128.0  ...         0.0         0.0  119.0
265596 2018-03-17 08:55:00  107.0      126.0  ...         0.0         0.0  114.0
265597 2018-03-17 09:00:00  108.0      127.0  ...         0.0         0.0  108.0
265598 2018-03-17 09:05:00  109.0      127.0  ...         0.0         0.0  105.0

[10 rows x 111 columns]
2024-04-21 11:01:14 Saved model's file: ./tmp/lstm_weights/1900976.pt
2024-04-21 11:01:19 0 [train] 1.0032611118740966 [valid] 0.9262450643121568
2024-04-21 11:01:39 0 [train] 0.5610257572001482 [valid] 0.5174338674166711
2024-04-21 11:02:00 1 [train] 0.5470774886028393 [valid] 0.5078023754601936
2024-04-21 11:02:23 2 [train] 0.5381007639173435 [valid] 0.5006293812835265
2024-04-21 11:02:41 EarlyStopping counter: 1 out of 50
2024-04-21 11:02:41 3 [train] 0.5320168300830499 [valid] 0.5014486062892358
2024-04-21 11:03:01 4 [train] 0.524483676296922 [valid] 0.49823122344178844
2024-04-21 11:03:25 EarlyStopping counter: 1 out of 50
2024-04-21 11:03:25 5 [train] 0.5211255850075023 [valid] 0.49924514924459334
2024-04-21 11:03:45 EarlyStopping counter: 2 out of 50
2024-04-21 11:03:45 6 [train] 0.5238969490325678 [valid] 0.5024579101947015
2024-04-21 11:04:04 7 [train] 0.5132909325678222 [valid] 0.4978643401836503
2024-04-21 11:04:21 EarlyStopping counter: 1 out of 50
2024-04-21 11:04:21 8 [train] 0.5103916348582851 [valid] 0.503570521615019
2024-04-21 11:04:37 EarlyStopping counter: 2 out of 50
2024-04-21 11:04:37 9 [train] 0.5118661173418241 [valid] 0.5039059344535735
2024-04-21 11:04:53 EarlyStopping counter: 3 out of 50
2024-04-21 11:04:53 10 [train] 0.49637505202836874 [valid] 0.49886803210552844
2024-04-21 11:05:11 EarlyStopping counter: 4 out of 50
2024-04-21 11:05:11 11 [train] 0.49859956967232577 [valid] 0.5024875416322673
2024-04-21 11:05:32 EarlyStopping counter: 5 out of 50
2024-04-21 11:05:32 12 [train] 0.4887604489785319 [valid] 0.5025008922442646
2024-04-21 11:05:51 EarlyStopping counter: 6 out of 50
2024-04-21 11:05:51 13 [train] 0.4820367326973623 [valid] 0.5134858692147046
2024-04-21 11:06:10 EarlyStopping counter: 7 out of 50
2024-04-21 11:06:10 14 [train] 0.4762499841607938 [valid] 0.5110765424750051
2024-04-21 11:06:30 EarlyStopping counter: 8 out of 50
2024-04-21 11:06:30 15 [train] 0.4688464139822294 [valid] 0.520426939129847
2024-04-21 11:06:48 EarlyStopping counter: 9 out of 50
2024-04-21 11:06:48 16 [train] 0.46150053986623063 [valid] 0.5220686230803187
2024-04-21 11:07:06 EarlyStopping counter: 10 out of 50
2024-04-21 11:07:06 17 [train] 0.44562895581637624 [valid] 0.5282498671734235
2024-04-21 11:07:26 EarlyStopping counter: 11 out of 50
2024-04-21 11:07:26 18 [train] 0.42800396908598953 [valid] 0.5458677587195035
2024-04-21 11:07:44 EarlyStopping counter: 12 out of 50
2024-04-21 11:07:44 19 [train] 0.41865327602639557 [valid] 0.5509460200173933
2024-04-21 11:08:03 EarlyStopping counter: 13 out of 50
2024-04-21 11:08:03 20 [train] 0.3974800270760751 [valid] 0.5543815993823461
2024-04-21 11:08:27 EarlyStopping counter: 14 out of 50
2024-04-21 11:08:27 21 [train] 0.3842706627127172 [valid] 0.5702323938974462
2024-04-21 11:08:46 EarlyStopping counter: 15 out of 50
2024-04-21 11:08:46 22 [train] 0.3696697474281853 [valid] 0.5913559515785933
2024-04-21 11:09:08 EarlyStopping counter: 16 out of 50
2024-04-21 11:09:08 23 [train] 0.34803036054377495 [valid] 0.6000266612184424
2024-04-21 11:09:27 EarlyStopping counter: 17 out of 50
2024-04-21 11:09:27 24 [train] 0.3327693896640612 [valid] 0.6178843438037644
2024-04-21 11:09:46 EarlyStopping counter: 18 out of 50
2024-04-21 11:09:46 25 [train] 0.3248389494303266 [valid] 0.6224582790676423
2024-04-21 11:10:06 EarlyStopping counter: 19 out of 50
2024-04-21 11:10:06 26 [train] 0.30970909716138806 [valid] 0.6373841681912183
2024-04-21 11:10:26 EarlyStopping counter: 20 out of 50
2024-04-21 11:10:26 27 [train] 0.2881070091134533 [valid] 0.6406201784163914
2024-04-21 11:10:45 EarlyStopping counter: 21 out of 50
2024-04-21 11:10:45 28 [train] 0.2695707658986089 [valid] 0.6707948144167424
2024-04-21 11:11:05 EarlyStopping counter: 22 out of 50
2024-04-21 11:11:05 29 [train] 0.25253667976320837 [valid] 0.6698150301168194
2024-04-21 11:11:24 EarlyStopping counter: 23 out of 50
2024-04-21 11:11:24 30 [train] 0.24336182589983432 [valid] 0.6813811973186341
2024-04-21 11:11:45 EarlyStopping counter: 24 out of 50
2024-04-21 11:11:45 31 [train] 0.22334795928078388 [valid] 0.6902987883033348
2024-04-21 11:12:05 EarlyStopping counter: 25 out of 50
2024-04-21 11:12:05 32 [train] 0.22735157108408557 [valid] 0.6853844488366059
2024-04-21 11:12:21 EarlyStopping counter: 26 out of 50
2024-04-21 11:12:21 33 [train] 0.20760505300235724 [valid] 0.7109778753877951
2024-04-21 11:12:37 EarlyStopping counter: 27 out of 50
2024-04-21 11:12:37 34 [train] 0.19228168974243 [valid] 0.7185349298862798
2024-04-21 11:12:55 EarlyStopping counter: 28 out of 50
2024-04-21 11:12:55 35 [train] 0.1849255029573744 [valid] 0.7199781177717541
2024-04-21 11:13:14 EarlyStopping counter: 29 out of 50
2024-04-21 11:13:14 36 [train] 0.17137189493865115 [valid] 0.7262298425480604
2024-04-21 11:13:33 EarlyStopping counter: 30 out of 50
2024-04-21 11:13:33 37 [train] 0.1674951208075384 [valid] 0.7229457354346982
2024-04-21 11:13:53 EarlyStopping counter: 31 out of 50
2024-04-21 11:13:53 38 [train] 0.15828493755228915 [valid] 0.74250530987716
2024-04-21 11:14:10 EarlyStopping counter: 32 out of 50
2024-04-21 11:14:10 39 [train] 0.15238924594422523 [valid] 0.7334338134030619
2024-04-21 11:14:31 EarlyStopping counter: 33 out of 50
2024-04-21 11:14:31 40 [train] 0.14084567545907029 [valid] 0.7460068648822215
2024-04-21 11:14:52 EarlyStopping counter: 34 out of 50
2024-04-21 11:14:52 41 [train] 0.13504694924614083 [valid] 0.7511939274660056
2024-04-21 11:15:12 EarlyStopping counter: 35 out of 50
2024-04-21 11:15:12 42 [train] 0.1310621464907618 [valid] 0.7420176633777424
2024-04-21 11:15:31 EarlyStopping counter: 36 out of 50
2024-04-21 11:15:31 43 [train] 0.12490076826542805 [valid] 0.7621547165319029
2024-04-21 11:15:49 EarlyStopping counter: 37 out of 50
2024-04-21 11:15:49 44 [train] 0.11770721452120148 [valid] 0.7401188958076024
2024-04-21 11:16:11 EarlyStopping counter: 38 out of 50
2024-04-21 11:16:11 45 [train] 0.11628549722547339 [valid] 0.7647093683074081
2024-04-21 11:16:30 EarlyStopping counter: 39 out of 50
2024-04-21 11:16:30 46 [train] 0.10902757263056517 [valid] 0.7558987421101107
2024-04-21 11:16:50 EarlyStopping counter: 40 out of 50
2024-04-21 11:16:50 47 [train] 0.10616069185645567 [valid] 0.7560948657245565
2024-04-21 11:17:14 EarlyStopping counter: 41 out of 50
2024-04-21 11:17:14 48 [train] 0.10335857811211174 [valid] 0.7775687904624424
2024-04-21 11:17:33 EarlyStopping counter: 42 out of 50
2024-04-21 11:17:33 49 [train] 0.100844187757463 [valid] 0.7693097659669108
2024-04-21 11:17:53 EarlyStopping counter: 43 out of 50
2024-04-21 11:17:53 50 [train] 0.09700514490772068 [valid] 0.7791014422597724
2024-04-21 11:18:12 EarlyStopping counter: 44 out of 50
2024-04-21 11:18:12 51 [train] 0.09443249993046968 [valid] 0.7780978168312431
2024-04-21 11:18:31 EarlyStopping counter: 45 out of 50
2024-04-21 11:18:31 52 [train] 0.08839897813480176 [valid] 0.7832130512093279
2024-04-21 11:18:50 EarlyStopping counter: 46 out of 50
2024-04-21 11:18:50 53 [train] 0.08578831066531263 [valid] 0.7748337171914563
2024-04-21 11:19:12 EarlyStopping counter: 47 out of 50
2024-04-21 11:19:12 54 [train] 0.0889293334373416 [valid] 0.7773838939474603
2024-04-21 11:19:35 EarlyStopping counter: 48 out of 50
2024-04-21 11:19:35 55 [train] 0.08760276934014305 [valid] 0.7831248434720285
2024-04-21 11:19:53 EarlyStopping counter: 49 out of 50
2024-04-21 11:19:53 56 [train] 0.08195342307699097 [valid] 0.7838523286670845
2024-04-21 11:20:17 EarlyStopping counter: 50 out of 50
2024-04-21 11:20:17 57 [train] 0.07885205240274758 [valid] 0.7785123257107937
2024-04-21 11:20:17 Early Stopped.
