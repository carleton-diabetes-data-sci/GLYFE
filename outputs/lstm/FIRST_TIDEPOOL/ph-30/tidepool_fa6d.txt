2024-04-21 10:35:26 tidepool fa6d lstm lstm FIRST_TIDEPOOL test None 30 1
             datetime  glucose  CHO  insulin
0 2015-09-07 17:00:00    104.0  NaN      NaN
1 2015-09-07 17:05:00     99.0  NaN      NaN
2 2015-09-07 17:10:00     96.0  NaN      NaN
3 2015-09-07 17:15:00     94.0  NaN      NaN
4 2015-09-07 17:20:00     94.0  NaN      NaN
Printing heads of split dataset
Train
               datetime   time  glucose_0  ...  insulin_34  insulin_35     y
100 2015-09-08 08:20:00  100.0      167.0  ...         0.0         0.0  98.0
101 2015-09-08 08:25:00  101.0      171.0  ...         0.0         0.0  96.0
102 2015-09-08 08:30:00  102.0      172.0  ...         0.0         0.0  84.0
103 2015-09-08 08:35:00  103.0      173.0  ...         0.0         0.0  85.0
104 2015-09-08 08:40:00  104.0      175.0  ...         0.0         0.0  90.0
105 2015-09-08 08:45:00  105.0      176.0  ...         0.0         0.0  88.0
106 2015-09-08 08:50:00  106.0      179.0  ...         0.0         0.0  85.0
107 2015-09-08 08:55:00  107.0      177.0  ...         0.0         0.0  78.0
108 2015-09-08 09:00:00  108.0      173.0  ...         0.0         0.0  78.0
109 2015-09-08 09:05:00  109.0      173.0  ...         0.0         0.0  82.0

[10 rows x 111 columns]
Valid
               datetime   time  glucose_0  ...  insulin_34  insulin_35      y
100 2015-09-10 08:20:00  100.0       96.0  ...         0.0         0.0  113.0
101 2015-09-10 08:25:00  101.0       91.0  ...         0.0         0.0  116.0
102 2015-09-10 08:30:00  102.0       91.0  ...         0.0         0.0  141.0
103 2015-09-10 08:35:00  103.0       89.0  ...         0.0         0.0  133.0
104 2015-09-10 08:40:00  104.0       89.0  ...         0.0         0.0  133.0
105 2015-09-10 08:45:00  105.0       87.0  ...         0.0         0.0  133.0
106 2015-09-10 08:50:00  106.0       85.0  ...         0.0         0.0  146.0
107 2015-09-10 08:55:00  107.0       83.0  ...         0.0         0.0  152.0
108 2015-09-10 09:00:00  108.0       82.0  ...         0.0         0.0  156.0
109 2015-09-10 09:05:00  109.0       81.0  ...         0.0         0.0  162.0

[10 rows x 111 columns]
Test
                  datetime   time  glucose_0  ...  insulin_34  insulin_35      y
265595 2018-03-17 08:20:00  100.0      128.0  ...         0.0         0.0  134.0
265596 2018-03-17 08:25:00  101.0      126.0  ...         0.0         0.0  135.0
265597 2018-03-17 08:30:00  102.0      127.0  ...         0.0         0.0  133.0
265598 2018-03-17 08:35:00  103.0      127.0  ...         0.0         0.0  131.0
265599 2018-03-17 08:40:00  104.0      127.0  ...         0.0         0.0  127.0
265600 2018-03-17 08:45:00  105.0      126.0  ...         0.0         0.0  121.0
265601 2018-03-17 08:50:00  106.0      126.0  ...         0.0         0.0  119.0
265602 2018-03-17 08:55:00  107.0      127.0  ...         0.0         0.0  114.0
265603 2018-03-17 09:00:00  108.0      127.0  ...         0.0         0.0  108.0
265604 2018-03-17 09:05:00  109.0      126.0  ...         0.0         0.0  105.0

[10 rows x 111 columns]
2024-04-21 10:38:41 Saved model's file: ./tmp/lstm_weights/9671334.pt
2024-04-21 10:38:45 0 [train] 1.0042428366481777 [valid] 0.9266087729660416
2024-04-21 10:39:07 0 [train] 0.27805418871375315 [valid] 0.2517337760332313
2024-04-21 10:39:27 1 [train] 0.26803421944754635 [valid] 0.24144256441992562
2024-04-21 10:39:44 2 [train] 0.26653147729305626 [valid] 0.24058688511970705
2024-04-21 10:40:10 3 [train] 0.25925569669784154 [valid] 0.23521226294060463
2024-04-21 10:40:26 4 [train] 0.2542595715805763 [valid] 0.23420299392133617
2024-04-21 10:40:42 5 [train] 0.24964568895748537 [valid] 0.23217828652791567
2024-04-21 10:40:58 EarlyStopping counter: 1 out of 50
2024-04-21 10:40:58 6 [train] 0.24928202943739114 [valid] 0.23374099445995283
2024-04-21 10:41:14 EarlyStopping counter: 2 out of 50
2024-04-21 10:41:14 7 [train] 0.24753893191251364 [valid] 0.2334253889157961
2024-04-21 10:41:30 8 [train] 0.24405444706097051 [valid] 0.23051967889140698
2024-04-21 10:41:46 9 [train] 0.2423243620682183 [valid] 0.22923633633031973
2024-04-21 10:42:02 EarlyStopping counter: 1 out of 50
2024-04-21 10:42:02 10 [train] 0.24290840131281471 [valid] 0.23239693234317302
2024-04-21 10:42:18 EarlyStopping counter: 2 out of 50
2024-04-21 10:42:18 11 [train] 0.24095866836365126 [valid] 0.231063567049905
2024-04-21 10:42:35 EarlyStopping counter: 3 out of 50
2024-04-21 10:42:35 12 [train] 0.24061595513086365 [valid] 0.23185998009583664
2024-04-21 10:42:53 EarlyStopping counter: 4 out of 50
2024-04-21 10:42:53 13 [train] 0.241127143377283 [valid] 0.23391130497468002
2024-04-21 10:43:12 EarlyStopping counter: 5 out of 50
2024-04-21 10:43:12 14 [train] 0.24031546285445973 [valid] 0.23146506971927808
2024-04-21 10:43:35 EarlyStopping counter: 6 out of 50
2024-04-21 10:43:35 15 [train] 0.23615315717916666 [valid] 0.2316338202481417
2024-04-21 10:44:00 EarlyStopping counter: 7 out of 50
2024-04-21 10:44:00 16 [train] 0.23539032609308336 [valid] 0.23137536681127596
2024-04-21 10:44:16 EarlyStopping counter: 8 out of 50
2024-04-21 10:44:16 17 [train] 0.23363930279712708 [valid] 0.23509576945713112
2024-04-21 10:44:35 EarlyStopping counter: 9 out of 50
2024-04-21 10:44:35 18 [train] 0.23263474044735266 [valid] 0.2324271640156445
2024-04-21 10:44:53 EarlyStopping counter: 10 out of 50
2024-04-21 10:44:53 19 [train] 0.23371595497654432 [valid] 0.23706021181780187
2024-04-21 10:45:09 EarlyStopping counter: 11 out of 50
2024-04-21 10:45:09 20 [train] 0.22781704127298233 [valid] 0.2390118472678965
2024-04-21 10:45:25 EarlyStopping counter: 12 out of 50
2024-04-21 10:45:25 21 [train] 0.22766866683568338 [valid] 0.23426261565191528
2024-04-21 10:45:41 EarlyStopping counter: 13 out of 50
2024-04-21 10:45:41 22 [train] 0.22540813789324957 [valid] 0.23980756195714714
2024-04-21 10:45:57 EarlyStopping counter: 14 out of 50
2024-04-21 10:45:57 23 [train] 0.22376045965043864 [valid] 0.23392185974522517
2024-04-21 10:46:13 EarlyStopping counter: 15 out of 50
2024-04-21 10:46:13 24 [train] 0.2206664041865961 [valid] 0.2382362499687425
2024-04-21 10:46:29 EarlyStopping counter: 16 out of 50
2024-04-21 10:46:29 25 [train] 0.2203775024289605 [valid] 0.24139795880489356
2024-04-21 10:46:45 EarlyStopping counter: 17 out of 50
2024-04-21 10:46:45 26 [train] 0.21921147891491383 [valid] 0.24025278877242864
2024-04-21 10:47:01 EarlyStopping counter: 18 out of 50
2024-04-21 10:47:01 27 [train] 0.21477948681172962 [valid] 0.24003899900670334
2024-04-21 10:47:19 EarlyStopping counter: 19 out of 50
2024-04-21 10:47:19 28 [train] 0.2143940697401681 [valid] 0.24594820103687862
2024-04-21 10:47:36 EarlyStopping counter: 20 out of 50
2024-04-21 10:47:36 29 [train] 0.21407276777401452 [valid] 0.24327085574821566
2024-04-21 10:47:56 EarlyStopping counter: 21 out of 50
2024-04-21 10:47:56 30 [train] 0.2112924849694182 [valid] 0.24444807314761888
2024-04-21 10:48:19 EarlyStopping counter: 22 out of 50
2024-04-21 10:48:19 31 [train] 0.20707768098051502 [valid] 0.247489088426361
2024-04-21 10:48:43 EarlyStopping counter: 23 out of 50
2024-04-21 10:48:43 32 [train] 0.205133694845799 [valid] 0.24704794277324582
2024-04-21 10:49:01 EarlyStopping counter: 24 out of 50
2024-04-21 10:49:01 33 [train] 0.2063243503727432 [valid] 0.2556184763106701
2024-04-21 10:49:23 EarlyStopping counter: 25 out of 50
2024-04-21 10:49:23 34 [train] 0.20021114606448573 [valid] 0.25344099558002353
2024-04-21 10:49:39 EarlyStopping counter: 26 out of 50
2024-04-21 10:49:39 35 [train] 0.19902064217161872 [valid] 0.2510425041658488
2024-04-21 10:49:55 EarlyStopping counter: 27 out of 50
2024-04-21 10:49:55 36 [train] 0.20126022954402514 [valid] 0.26328959595904133
2024-04-21 10:50:12 EarlyStopping counter: 28 out of 50
2024-04-21 10:50:12 37 [train] 0.19524716767923733 [valid] 0.26061530948490624
2024-04-21 10:50:30 EarlyStopping counter: 29 out of 50
2024-04-21 10:50:30 38 [train] 0.19072781542578382 [valid] 0.26722969874985447
2024-04-21 10:50:48 EarlyStopping counter: 30 out of 50
2024-04-21 10:50:48 39 [train] 0.187990656791985 [valid] 0.26246950989676276
2024-04-21 10:51:08 EarlyStopping counter: 31 out of 50
2024-04-21 10:51:08 40 [train] 0.18770783212904935 [valid] 0.2718485340603729
2024-04-21 10:51:27 EarlyStopping counter: 32 out of 50
2024-04-21 10:51:27 41 [train] 0.18520008422272108 [valid] 0.26641818213363067
2024-04-21 10:51:49 EarlyStopping counter: 33 out of 50
2024-04-21 10:51:49 42 [train] 0.18449187494935598 [valid] 0.27318944096741155
2024-04-21 10:52:08 EarlyStopping counter: 34 out of 50
2024-04-21 10:52:08 43 [train] 0.18237927069429033 [valid] 0.276518599889423
2024-04-21 10:52:27 EarlyStopping counter: 35 out of 50
2024-04-21 10:52:27 44 [train] 0.17423827350810653 [valid] 0.27757843367407575
2024-04-21 10:52:46 EarlyStopping counter: 36 out of 50
2024-04-21 10:52:46 45 [train] 0.17365345640676272 [valid] 0.27662013348063474
2024-04-21 10:53:07 EarlyStopping counter: 37 out of 50
2024-04-21 10:53:07 46 [train] 0.16736060514793608 [valid] 0.28253478201561044
2024-04-21 10:53:27 EarlyStopping counter: 38 out of 50
2024-04-21 10:53:27 47 [train] 0.16713045424027298 [valid] 0.2805712847575274
2024-04-21 10:53:45 EarlyStopping counter: 39 out of 50
2024-04-21 10:53:45 48 [train] 0.16547379861885506 [valid] 0.28459583018277
2024-04-21 10:54:10 EarlyStopping counter: 40 out of 50
2024-04-21 10:54:10 49 [train] 0.16006279666536294 [valid] 0.28645311031561266
2024-04-21 10:54:29 EarlyStopping counter: 41 out of 50
2024-04-21 10:54:29 50 [train] 0.15983176497859147 [valid] 0.29329422961951246
2024-04-21 10:54:49 EarlyStopping counter: 42 out of 50
2024-04-21 10:54:49 51 [train] 0.1576192313372263 [valid] 0.29168409493772524
2024-04-21 10:55:07 EarlyStopping counter: 43 out of 50
2024-04-21 10:55:07 52 [train] 0.15696957961644514 [valid] 0.2981749341405264
2024-04-21 10:55:29 EarlyStopping counter: 44 out of 50
2024-04-21 10:55:29 53 [train] 0.15339050191742631 [valid] 0.2923338534268252
2024-04-21 10:55:47 EarlyStopping counter: 45 out of 50
2024-04-21 10:55:47 54 [train] 0.1468632824787988 [valid] 0.29104651631662637
2024-04-21 10:56:06 EarlyStopping counter: 46 out of 50
2024-04-21 10:56:06 55 [train] 0.1449502889930847 [valid] 0.2931846107696071
2024-04-21 10:56:24 EarlyStopping counter: 47 out of 50
2024-04-21 10:56:24 56 [train] 0.14363587367301567 [valid] 0.2988758042619718
2024-04-21 10:56:44 EarlyStopping counter: 48 out of 50
2024-04-21 10:56:44 57 [train] 0.14176607800716373 [valid] 0.3106579560417193
2024-04-21 10:57:06 EarlyStopping counter: 49 out of 50
2024-04-21 10:57:06 58 [train] 0.13964065820270907 [valid] 0.3002896596063816
2024-04-21 10:57:24 EarlyStopping counter: 50 out of 50
2024-04-21 10:57:24 59 [train] 0.13719815690187767 [valid] 0.3084637113049697
2024-04-21 10:57:24 Early Stopped.
